<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"    
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">
    <h:body>
        <ui:composition template="../template/mainLayout.xhtml">
            <ui:define name="content">
                <div class="mainPanelAmplio" >
                    <h:form id="mainForm">
                        <p:messages id="validaMsg" class="validaMsg" globalOnly="true" closable="true" >
                            <p:autoUpdate />
                        </p:messages>
                        <p:focus context="mainForm"/>

                        <div id="busqueda" style="height: 30px !important;">
                            <p:outputLabel value="Acondicionamiento de Mezclas"  style="color: #FFFFFF;font-size: 18px !important;font-weight: bold;margin-right: 50px;" />
                            <p:selectCheckboxMenu id="menu" value="#{acondicionarSolucionesMB.tipoPrescripcionSelectedList}" label="Tipo" title="Filtro por tipo de Prescripción"
                                                  filter="true" filterMatchMode="startsWith" panelStyle="width:110px" style="width: 110px;">
                                <f:selectItem value="#{N}" itemLabel="Normal" itemValue="N" />
                                <f:selectItem value="#{U}" itemLabel="Urgente" itemValue="U" />
                                <f:selectItem value="#{D}" itemLabel="Dosis Única" itemValue="D" />
                            </p:selectCheckboxMenu>
                            <p:spacer width="10px;" />
                            <p:inputText id="busqueda" 
                                         value="#{acondicionarSolucionesMB.cadenaBusqueda}" 
                                         class="textSearch"
                                         style="width: 50% !important;" 
                                         placeholder="Buscar..." title="Buscar por Número de Cama, Paciente o Servicio" />
                            <i class="fa fa-search" aria-hidden="true" style="position:absolute;  text-indent: 5px; margin-top: 3px; margin-left: -25px; color: #AAAAAA; font-size: 0.9em;" />
                            <p:spacer width="12px" />
                            <p:commandButton title="Buscar" value="Buscar" icon="ui-icon-search" 
                                             onclick="PF('statusProcess').show();"
                                             oncomplete="PF('statusProcess').hide(); if(args.modal){PF(':formSurtimientoDetail').show();}"
                                             actionListener="#{acondicionarSolucionesMB.obtenerSoluciones}"
                                             update="@form"  />
                        </div>
 
                        <p:tabView>
                            <p:ajax event="tabChange" process="@this" update="mainForm:tblSoluciones" listener="#{acondicionarSolucionesMB.onTabChange}"/>
                            <p:tab title="CONFORMES" id="#{acondicionarSolucionesMB.mezcla_correcta}" ></p:tab>
                            <p:tab title="ACONDICIONADAS" id="#{acondicionarSolucionesMB.acondicionada}" ></p:tab>
                            <p:tab title="ENTREGADAS" id="#{acondicionarSolucionesMB.entregada}" rendered="false" ></p:tab>
                            <p:tab title="NO ACONDICIONADAS" id="#{acondicionarSolucionesMB.no_acondicionada}" ></p:tab>
                        </p:tabView>

                        <p:panel id="dataTable" style="margin:-28px 0px;">
                            <p:dataTable id="tblSoluciones"
                                         widgetVar="tblSoluciones"                                         
                                         value="#{acondicionarSolucionesMB.dispensacionSolucionLazy}"
                                         lazy="true"                                         
                                         selection="#{acondicionarSolucionesMB.surtimientoExtendedSelected}"
                                         var="item"
                                         rowKey="#{item.idSurtimiento}"
                                         rowIndexVar="row"
                                         selectionMode="single"
                                         style="margin-bottom:5px;"
                                         styleClass="mystyle"
                                         scrollRows="10" scrollable="true" scrollHeight="350"
                                         emptyMessage="No se encontraron Registros"
                                         reflow="true"
                                         paginatorTemplate=" {CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
                                         currentPageReportTemplate=" "
                                         paginator="true"
                                         rows="10"
                                         paginatorPosition="bottom"
                                         rowStyleClass="#{item.tipoPrescripcion eq 'U' ? 'urgente' : item.tipoPrescripcion eq 'D' ? 'unica': null}" >
                                
                                <p:ajax event="rowDblselect" listener="#{acondicionarSolucionesMB.verSolucion}" update=":formSurtimientoDetail"
                                        onstart="PF('statusProcess').show()"
                                        oncomplete="PF('statusProcess').hide(); if (args.modal){ PF('modalSolucion').show();}" />
                             
                                <p:column style="text-align: left; width: 6% " exportable="false" 
                                          sortBy="#{item.tipoPrescripcion}" 
                                          filterBy="#{item.tipoPrescripcion}" filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Tipo" />
                                    </f:facet>
                                    <p:outputPanel rendered="#{item.tipoPrescripcion eq 'N'}" >
                                        <img src="#{request.contextPath}/resources/img/cpnormal.png" style="height: 15px !important; margin-left: 0px !important;" />
                                        <p:spacer width="8px"/>
                                        <h:outputText value="Normal"/>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{item.tipoPrescripcion eq 'U'}" >
                                        <img src="#{request.contextPath}/resources/img/cpurgente.png" style="height: 15px !important; margin-left: 0px !important;" />
                                        <p:spacer width="8px"/>
                                        <h:outputText value="Urgente"/>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{item.tipoPrescripcion eq 'D'}" >
                                        <img src="#{request.contextPath}/resources/img/cpunica.png" style="height: 15px !important; margin-left: 0px !important;" />
                                        <p:spacer width="8px"/>
                                        <h:outputText value="Dosis Única"/>
                                    </p:outputPanel>
                                </p:column>

                                <p:column style="text-align: left; width: 6% "
                                          sortBy="#{item.tipoSolucion}" 
                                          filterBy="#{item.tipoSolucion}" filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Solución" />
                                    </f:facet>
                                    <h:outputText value="#{item.tipoSolucion}" />
                                </p:column>
                                
                                <p:column style="text-align: left; width: 8% "
                                          sortBy="#{item.fechaProgramada}"
                                          filterBy="#{item.fechaProgramada}" filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Fecha Program." />
                                    </f:facet>
                                    <h:outputText value="#{item.fechaProgramada}"
                                                  styleClass="#{item.prioridad eq 'Alta' ? 'prioridadAlta' : item.prioridad eq 'Media' ? 'prioridadMedia' : item.prioridad eq 'Baja' ? 'prioridadBaja' : null}" >
                                        <f:convertDateTime pattern="yyyy-MM-dd HH:mm" />
                                    </h:outputText>
                                </p:column>

                                <p:column style="text-align: left; width: 6% "
                                          sortBy="#{item.folio}" 
                                          filterBy="#{item.folio}" filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Folio" />
                                    </f:facet>
                                    <h:outputText value="#{item.folio}" />
                                </p:column>

                                <p:column style="text-align: left; width: 12% " 
                                          sortBy="#{item.nombrePaciente}"
                                          filterBy="#{item.nombrePaciente}" filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Paciente" />
                                    </f:facet>
                                    <h:outputText value="#{item.nombrePaciente}" />
                                </p:column>
                                
                                <p:column style="text-align: left; width: 14% " 
                                           filterBy="#{item.descripcion}" filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Descripción Mezcla" />
                                    </f:facet>
                                    <h:outputText value="#{item.descripcion}" />
                                </p:column>

                                <p:column style="text-align: left; width: 10% " 
                                          sortBy="#{item.nombreEstructura}"
                                          filterBy="#{item.nombreEstructura}" filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Servicio " />
                                    </f:facet>
                                    <h:outputText title="#{item.nombreEstructura}" value="#{item.nombreEstructura}"  class="limitCarater"/>
                                </p:column>

                                <p:column style="text-align: left; width: 6% "
                                          sortBy="#{item.cama}"
                                          filterBy="#{item.cama}" filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Ubicación" />
                                    </f:facet>
                                    <h:outputText value="#{item.cama}" />
                                </p:column>

                                <p:column style="text-align: left; width: 10% " 
                                          sortBy="#{item.nombreMedico}" 
                                          filterBy="#{item.nombreMedico}" filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Médico" />
                                    </f:facet>
                                    <h:outputText value="#{item.nombreMedico}"  title="#{item.nombreEstructura}" class="limitCarater" />
                                </p:column>
                                
                                <p:column style="text-align: left; width: 10% " 
                                          sortBy="#{item.estatusSolucion}" 
                                          filterBy="#{item.estatusSolucion}"  filterMatchMode="contains" >
                                    <f:facet name="header" >
                                        <h:outputText value="Estatus" />
                                    </f:facet>
                                    <h:outputText value="#{item.estatusSolucion}" />
                                </p:column>
                                
                                <p:column style="width: 6%;" >
                                    <f:facet name="header" >
                                        <h:outputText value="Acciones"  />
                                    </f:facet>
                                    <p:commandLink id="linkImprimir" onclick="PF('statusProcess').show();" 
                                                   oncomplete="PF('statusProcess').hide();if(args.estatus) {PF('mdlReport').show();}"
                                                   actionListener="#{acondicionarSolucionesMB.previewPrint(item)}"
                                                   style="margin: 5px;text-decoration: none;"
                                                   styleClass="iconMusAzul" 
                                                   update="formPDF"  >
                                        <i class="fa fa-print" style="font-size: large" />
                                    </p:commandLink>
                                    <p:commandLink id="linkImprimir3" onclick="PF('statusProcess').show();" title="Imprimir etiqueta" 
                                                   oncomplete="PF('statusProcess').hide(); if(args.estatus) { PF('mdlPrint').show(); }"
                                                   actionListener="#{acondicionarSolucionesMB.preImpresionEtiqueta(item)}"
                                                   style="margin: 5px;text-decoration: none;"
                                                   styleClass="iconMusAzul" update="frmPrintSelect"
                                                   rendered="#{acondicionarSolucionesMB.permiso.puedeAutorizar}" >
                                        <i class="fa fa-barcode" style="font-size: large" />
                                    </p:commandLink>
                                </p:column>
                            </p:dataTable>
                        </p:panel>

                    </h:form>
                </div>

                <p:dialog header="REGISTRO DE ACONDICIONAMIENTO DE MEZCLA"
                          widgetVar="modalSolucion"
                          closeOnEscape="true"
                          closable="true"
                          width="95%"
                          height="650px" 
                          position="30,10"
                          modal="true" 
                          resizable="false"
                          responsive="true"
                          style="font-size:xx-small !important; " >

                    <h:form id="formSurtimientoDetail"  >                        
                        <p:messages id="msgValidaRegistro" showDetail="false" globalOnly="false" closable="true" >
                                <p:autoUpdate />
                            </p:messages>
                        <div class="ui-g"  >
                            
                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Folio Surtimiento:"/>
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.folio}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Fecha Registro:"/>
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.insertFecha}">
                                        <f:convertDateTime type="date" pattern="dd/MM/yyyy HH:mm:ss" />
                                    </p:outputLabel>
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Estatus:"/>
                                    <p:outputLabel id="estatusSurtimiento" class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.estatusSurtimiento}" />
                                </div>
                            </div>

                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Folio Prescripción:"/>
                                    <p:outputLabel value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.folioPrescripcion}"
                                                   class="textoNegrita lbl-subtitulo" />
                                    <p:outputLabel class="lbl-Tipo-PrescripcionNormal" value="Normal" rendered="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tipoPrescripcion eq 'N'}" />
                                    <p:outputLabel class="lbl-Tipo-PrescripcionUnica" value="Única" rendered="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tipoPrescripcion eq 'D'}" />
                                    <p:outputLabel class="lbl-Tipo-PrescripcionUrgente" value="Urgente" rendered="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tipoPrescripcion eq 'U'}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Fecha Programada:"/>
                                    <p:outputLabel  class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.fechaProgramada}">
                                        <f:convertDateTime type="date" pattern="dd/MM/yyyy HH:mm" />
                                    </p:outputLabel>
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Tipo Prescripción:"/>
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tipoPrescripcion eq 'N' ? 'Normal' : acondicionarSolucionesMB.surtimientoExtendedSelected.tipoPrescripcion eq 'U' ? 'Urgente' : 'Dosis Única'}" />
                                </div>
                            </div>

                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Área/Servicio:"/>
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombreEstructura}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Cama:"/>
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.cama}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Médico Solicitante:" />
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombreMedico}" />
                                </div>
                            </div>

                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Paciente: "/>
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombrePaciente}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="No. Expediente:" />
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.pacienteNumero}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4">
                                    <p:outputLabel style="margin-right: 1px;" value="Tipo Consulta:"/>
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tipoConsulta eq 'I' ? 'Hospitalización': 'Ambulatoria'}" />
                                </div>
                            </div>

                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Fecha Nacimiento: " />
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.fechaNacimiento}" >
                                        <f:convertDateTime pattern="yyyy-MM-dd" />
                                    </p:outputLabel>
                                    <p:outputLabel value=" ( " />
                                    <p:outputLabel value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.edadPaciente}" />
                                    <p:outputLabel value=" años )" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Peso:"  />
                                    <p:outputLabel id="txtPesoPaciente" class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.pesoPaciente}" />
                                    <p:outputLabel value=" kg" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Estatura:"  />
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tallaPaciente}" />
                                    <p:outputLabel value=" mts" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="#{msg['cenmez.areaCorp']}:"  />
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.areaCorporal}" />
                                    <p:outputLabel value=" m²" />
                                </div>
                            </div>
                            
                            <p:outputLabel class="plabel ui-g-12" value="INFORMACIÓN DE LA SOLUCIÓN" />

                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Tipo Solución:" />
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tipoSolucion}" />
                                </div>                            
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;">Vía Administración:</p:outputLabel>
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombreViaAdministracion}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Volumen total:" />                                
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.volumenTotal}"  />
                                    <p:outputLabel value=" ml" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Contenedor: " />
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombreEnvaseContenedor}" />
                                </div>
                            </div>

                            <div class="ui-g-12" >
                                <ui:remove>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Fecha de Entrega: " /> 
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.fechaParaEntregar}" >
                                        <f:convertDateTime pattern="yyyy-MM-dd" />
                                    </p:outputLabel>
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Hora de Entrega: " /> 
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.fechaParaEntregar}" >
                                        <f:convertDateTime pattern="HH:mm" />
                                    </p:outputLabel>
                                </div>
                                </ui:remove>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Perfusión Continua:" />
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.perfusionContinua ? 'SI' : 'NO' }" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Tiempo Infusión:" />
                                    <p:outputLabel class="textoNegrita" value="#{(acondicionarSolucionesMB.surtimientoExtendedSelected.minutosInfusion gt 0) ? acondicionarSolucionesMB.surtimientoExtendedSelected.minutosInfusion : '' }" />
                                    <p:outputLabel value=" min." />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Velocidad:" />
                                    <p:outputLabel class="textoNegrita" value="#{(acondicionarSolucionesMB.surtimientoExtendedSelected.velocidad gt 0) ? acondicionarSolucionesMB.surtimientoExtendedSelected.velocidad : ''}" />
                                    <p:outputLabel value=" ml/h" />
                                </div>
                                <ui:remove>
                                    <div class="ui-g-12 ui-md-6 ui-lg-3">
                                        <p:outputLabel style="margin-right: 1px;" value="Ritmo:" />
                                        <p:outputLabel class="textoNegrita" value="#{(acondicionarSolucionesMB.surtimientoExtendedSelected.ritmo gt 0) ? acondicionarSolucionesMB.surtimientoExtendedSelected.ritmo : ''}" />
                                    </div>
                                </ui:remove>
                                
                            </div>
                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Protocolo:" />
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombreProtoclo}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-9">
                                    <p:outputLabel style="margin-right: 1px;" value="Diagnóstico:"/>
                                    <p:outputLabel class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombreDiagnostico}" />
                                </div>
                            </div>
                            
                            <div class="ui-g-12" >
                                <p:dataTable id="tblInsumos" 
                                             widgetVar="tblInsumos" 
                                             value="#{acondicionarSolucionesMB.surtimientoInsumoExtendedList}"
                                             selection="#{acondicionarSolucionesMB.surtimientoInsumoExtendedSelected}"                                     
                                             var="item" 
                                             rowKey="#{item.idSurtimientoInsumo}"
                                             rowIndexVar="row"
                                             selectionMode="single"
                                             style="margin-bottom:5px;"
                                             styleClass="mystyle"
                                             scrollable="true" scrollHeight="250"
                                             emptyMessage="No se encontraron Registros"
                                             reflow="true"
                                             disabledSelection="false" 
                                             rendered="#{acondicionarSolucionesMB.sizeSurtimientoInsumoExtendedList gt -1}" >
        <!--                            paginatorTemplate="{Records} {CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                                             paginator="false" rows="10" paginatorPosition="bottom" currentPageReportTemplate=" "-->
                                    <f:facet name="{Records}">
                                        <div style="float:left;">
                                            <p:outputLabel class="footerLabel" value="  Insumos Registrados: #{acondicionarSolucionesMB.sizeSurtimientoInsumoExtendedList}" rendered="true" />
                                        </div>
                                    </f:facet>
                                    <p:column style="text-align: left; width: 8% "
                                              sortBy="#{item.claveInstitucional}" >
                                        <f:facet name="header" >
                                            <h:outputText value="Clave" />
                                        </f:facet>
                                        <h:outputText value="#{item.claveInstitucional}" class="textoNegrita" />
                                    </p:column>
                                    <p:column style="text-align: left; width: 55% "
                                              sortBy="#{item.nombreCorto}" >
                                        <f:facet name="header" >
                                            <h:outputText value="Nombre" />
                                        </f:facet>
                                        <h:outputText value="#{item.nombreCorto}" title="#{item.nombreCorto}" class="limitText" />
                                    </p:column>
                                    <p:column style="text-align: left; width: 8% " >
                                        <f:facet name="header" >
                                            <h:outputText value="Dosis" />
                                        </f:facet>
                                        <h:outputText value="#{item.dosis} #{item.unidadConcentracion}" />
                                    </p:column>
                                    <p:column style="text-align: left; width: 8% " >
                                        <f:facet name="header" >
                                            <h:outputText value="Lote" />
                                        </f:facet>
                                        <h:outputText value="#{item.lote}" class="textoNegrita" />
                                    </p:column>
                                    <p:column style="text-align: left; width: 8% " >
                                        <f:facet name="header" >
                                            <h:outputText value="Caducidad" />
                                        </f:facet>
                                        <h:outputText value="#{item.caducidad}" class="textoNegrita" > 
                                            <f:convertDateTime type="date" pattern="dd/MM/yyyy" />
                                        </h:outputText>
                                    </p:column>
                                    <p:column style="text-align: left; width: 8% " >
                                        <f:facet name="header" >
                                            <h:outputText value="Fabricante" />
                                        </f:facet>
                                        <h:outputText value="#{item.nombreFabricante}" class="textoNegrita" />
                                    </p:column>
                                    <p:column style="text-align: left; width: 5% " >
                                        <f:facet name="header" >
                                            <h:outputText value="Estab (hrs) " title="No. horas estabilidad" />
                                        </f:facet>
                                        <h:outputText value="#{item.noHorasestabilidad}" class="textoNegrita" />
                                    </p:column>
                                </p:dataTable>
                                
                            </div>
                        
                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-6">
                                    <p:outputLabel style="margin-right: 1px; font-weight: bold;" value="Condiciones de Conservación:"/>
                                    <br/>
                                    <p:inputTextarea id="txtCondicionesConser" rows="3" cols="80" 
                                                     disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}"
                                                     value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.observaciones}" 
                                                     style="opacity: 99% !important;"/>
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-6">
                                    <p:outputLabel style="margin-right: 1px; font-weight: bold;" value="Instrucciones de Preparación:" />
                                    <br/>
                                    <p:inputTextarea id="txtInstruccionesPrep" rows="3" cols="80" 
                                                     disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}"
                                                     value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.instruccionPreparacion}"
                                                     style="opacity: 99% !important;" />
                                </div>
                            </div>

                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-6">
                                    <p:selectBooleanCheckbox id="chkTemRefrigeracion" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tempRefrigeracion}" 
                                                             itemLabel="Temp. Refrigeración" 
                                                             disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" />
                                    <p:selectBooleanCheckbox id="chkTemAmbiente" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tempAmbiente}" 
                                                             itemLabel="Temp. Ambiente" 
                                                             disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" />
                                    <p:selectBooleanCheckbox id="chkProteccionLuz" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.proteccionLuz}" 
                                                             itemLabel="Protección de Luz" 
                                                             disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" />
                                    <p:selectBooleanCheckbox id="chkNoAgitar" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.noAgitar}" 
                                                             itemLabel="No agitar" 
                                                             disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-6" >
                                    <p:outputLabel id="lblIndicaciones" style="margin-right: 1px; font-weight: bold;" value="Indicaciones: "
                                                   rendered="#{acondicionarSolucionesMB.surtimientoExtendedSelected.indicaciones ne null}"  />
                                    <br/>
                                    <p:inputTextarea id="txtIndicaciones" rows="3" cols="80"
                                                     value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.indicaciones}" 
                                                     style="opacity: 99% !important;"
                                                     rendered="#{acondicionarSolucionesMB.surtimientoExtendedSelected.indicaciones ne null}" 
                                                     disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" />
                                </div>
                            </div>
                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-3" >
                                    <p:outputLabel style="margin-right: 1px;" value="Clave Mezcla:" />
                                    <p:inputText value="#{acondicionarSolucionesMB.claveMezcla}" size="10"
                                                 style="opacity: 99% !important;"
                                                 required="true" requiredMessage="Clave de mezcla requerida"
                                                 disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" />
                                    <i class="fa fa-info-circle" 
                                       style="color: #004890; font-weight: bold; font-size: large;"
                                       title="Clave de identificación única de mezcla generada automáticamente." />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Lote Mezcla:" />
                                    <p:inputText value="#{acondicionarSolucionesMB.loteMezcla}" size="10"
                                                 style="opacity: 99% !important;"
                                                 required="true" requiredMessage="Lote requerido"
                                                 disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" />
                                    <i class="fa fa-info-circle" 
                                       style="color: #004890; font-weight: bold; font-size: large;"
                                       title="Lote de mezcla generada automáticamente."/>
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3" >
                                    <p:outputLabel style="margin-right: 1px;" value="Estabilidad" />
                                    <p:inputText value="#{acondicionarSolucionesMB.estabilidadMezcla}" size="5"
                                                 style="opacity: 99% !important;"
                                                 disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" />
                                    <p:outputLabel value=" hrs" />
                                    <i class="fa fa-info-circle" 
                                       style="color: #004890; font-weight: bold; font-size: large;"
                                       title="Número de horas de estabilidad mínimo de alguno de los insumos." />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3" >
                                    <p:outputLabel style="margin-right: 1px;" value="Fecha máxima de uso: " />
                                    <p:calendar value="#{acondicionarSolucionesMB.caducidadMezcla}"
                                                style=" opacity: 99% !important;"
                                                showOn="button" locale="es_MX" navigator="true" pattern="dd/MM/yyyy HH:mm"
                                                title="Fecha Programada" mindate="#{acondicionarSolucionesMB.fechaActual}"
                                                pages="1" mask="true" showButtonPanel="true" effect="fade" size="10" 
                                                required="true" requiredMessage="Fecha de Caducidad requerida"
                                                disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" />
                                    <i class="fa fa-info-circle" 
                                       style="color: #004890; font-weight: bold; font-size: large;"
                                       title="Fecha de caducidad calculada con la fecha actual mas el número mínimo de horas de estabilidad." />
                                </div>
                            </div>
                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-6" >
                                    <p:outputLabel style="margin-right: 1px; " value="Comentarios:" />
                                    <p:inputTextarea rows="1" cols="60"
                                                     value="#{acondicionarSolucionesMB.solucionSelect.comentarioAcondicionada}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3" >
                                    <p:outputLabel style="margin-right: 1px;" value="Almacenamiento: " />
                                    <p:selectOneMenu id="cmbAlmacenada" value="#{acondicionarSolucionesMB.solucionSelect.donde}" 
                                                     label="Lugar almacenamiento" style="vertical-align: middle;" 
                                                     filter="true" filterMatchMode="contains" editable="false" >
                                            <f:selectItem itemLabel="Seleccione lugar" itemValue="#{null}"/>
                                            <f:selectItem itemLabel="Refrigerador" itemValue="Refrigerador" />
                                            <f:selectItem itemLabel="Anaquel" itemValue="Anaquel" />
                                            <f:selectItem itemLabel="Otro" itemValue="Otro" />
                                        </p:selectOneMenu>
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3" >
                                    <p:outputLabel style="margin-right: 1px;" value="Acondicionamiento: " />
                                    <p:selectOneMenu id="cmbAconndicionamientno" 
                                                     value="#{acondicionarSolucionesMB.mezclaAcondicionada}"
                                                     label="Acondicionamiento" autoWidth="true" style="vertical-align: middle;" 
                                                     filter="true" filterMatchMode="contains" editable="false" >
                                            <f:selectItem itemLabel="Seleccione una opción" itemValue="-1"/>
                                            <f:selectItem itemLabel="Conforme" itemValue="1" />
                                            <f:selectItem itemLabel="No conforme" itemValue="0" />
                                        </p:selectOneMenu>
                                </div>
                            </div>
                        </div>
                        
                        <div class="ui-g">
                            <div class="ui-g-12" style=" width: 100% !important; /*position: absolute; bottom: 0px;*/ background-color: #f8f8f8; border-top: solid 2px #C8C8C8;  " >
                                <div class="ui-g-12 ui-md-6 ui-lg-6" style="display: flex; align-content: center; justify-content: space-between; float: right;" >
                                    <div  >
                                        <p:commandButton value="Cerrar" icon="fa fa-times-circle"  onclick="PF('modalSolucion').hide();"
                                         style="margin-right: 1px;float: right;" /> 
                                    </div>
                                    <div>
                                        <p:commandButton value="Cancelar" 
                                                         icon="fa fa-times-circle" style="margin-right: 10px;float: right;" 
                                                         onclick="PF('statusProcess').show();"
                                                         oncomplete="PF('statusProcess').hide(); if (args.estatus) { PF('mdlMotivoCancel').show();} else { PF('modalSolucion').content.scrollTop('0') } "
                                                         actionListener="#{acondicionarSolucionesMB.validaCancelar}" 
                                                         styleClass="btnMusRed"
                                                         rendered="#{acondicionarSolucionesMB.permiso.puedeAutorizar}"
                                                         update=":mainForm:tblSoluciones , :mainForm:validaMsg , :formCancelarSolucion  " >
                                        </p:commandButton>
                                    </div>
                                    <div  >
                                        <p:commandButton value="No Acondicionada" styleClass="btnMusOrange" icon="fa fa-times-circle"
                                                         onclick="PF('mdlNoAcondicionada').show();"
                                                         style="margin-right: 1px;float: right; width: 180px !important;"
                                                         rendered="#{acondicionarSolucionesMB.editable}" >
                                        </p:commandButton>    
                                    </div>
                                    <div >
                                        <p:commandButton value="Acondicionada" icon="fa fa-check-circle" style="margin-right: 1px;float: right;"
                                                         onclick="PF('statusProcess').show()" 
                                                         oncomplete="PF('statusProcess').hide(); if (args.estatus){PF('modalSolucion').hide();}  else { PF('modalSolucion').content.scrollTop('0') }"
                                                         actionListener="#{acondicionarSolucionesMB.acondicionada()}"
                                                         styleClass="btnMusAzul" update=":mainForm:validaMsg, :mainForm:tblSoluciones"
                                                         rendered="#{acondicionarSolucionesMB.editable}"> 
                                            <p:confirm header="Confirmación de Acondicionamiento" message="¿Desea registrar el acondicionamiento de la mezcla?" icon="ui-icon-alert" />
                                        </p:commandButton>
                                    </div>
                                    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                                        <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                        <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                    </p:confirmDialog>
                                </div>
                            </div>
                        </div>
                    </h:form>
                </p:dialog>                
                
                <p:dialog header="MEZCLA NO ACONDICIONADA"
                          widgetVar="mdlNoAcondicionada"
                          closeOnEscape="true"
                          closable="true"
                          width="450px" 
                          modal="true" 
                          resizable="false"
                          responsive="true"
                          style="font-size:xx-small !important; " >

                    <h:form id="frmCofirmaRechazo"  >                        
                        <p:messages id="msgCancelar" showDetail="false" globalOnly="false" closable="true">
                            <p:autoUpdate />
                        </p:messages>
                        
                        <div class="ui-g" >
                            <div class="ui-g-12" >
                                <p:outputLabel class="textoNegrita lbl-subtitulo" 
                                               style="margin-right: 1px;" value="Seleccione el motivo:" />
                                <br/>
                                <p:selectOneMenu value="#{acondicionarSolucionesMB.idMotivoRechazo}" 
                                                 filter="true" filterPlaceholder="Seleccione motivo" >
                                    <f:selectItem itemLabel="Seleccionar un motivo" itemValue="#{null}" />
                                    <f:selectItems value="#{acondicionarSolucionesMB.listaMotivosRechazo}" 
                                                   var="motivo" itemLabel="#{motivo.motivo}" itemValue="#{motivo.idMotivoRechazo}" />
                                </p:selectOneMenu>                                    
                            </div>
                            <div class="ui-g-12" >
                                <p:outputLabel class="textoNegrita lbl-subtitulo" style="margin-right: 1px;" 
                                               value="Comentarios:" />
                                <br/>
                                <p:inputTextarea rows="3" cols="47"  autoResize="false"
                                                 value="#{acondicionarSolucionesMB.comentarios}" />
                            </div>

                            <div class="ui-g-12" style=" width: 95% !important; /*position: absolute; bottom: 0px;*/ background-color: #f8f8f8; border-top: solid 2px #C8C8C8;  " >
                                <div class="ui-g-12 ui-md-6 ui-lg-9" style="display: flex; align-content: center; justify-content: space-between; float: right;" >
                                    <div>
                                        <p:commandButton value="Cancelar"  icon="fa fa-times-circle" onclick="PF('mdlNoAcondicionada').hide();"                                          
                                                         style="margin-right: 1px;float: right;" /> 
                                    </div>
                                    <div  >
                                        <p:commandButton value="Confirmación" icon="fa fa-check-circle" style="margin-right: 1px;float: right;"
                                                         onclick="PF('statusProcess').show()" 
                                                         oncomplete="PF('statusProcess').hide(); if(args.estatus){PF('mdlNoAcondicionada').hide();PF('modalSolucion').hide();}"
                                                         actionListener="#{acondicionarSolucionesMB.noAcondicionada()}" 
                                                         styleClass="btnMusAzul" update=":mainForm:tblSoluciones" > 
                                            <p:confirm header="Confirmación" message="¿Desea registrar acondicioamiento no conforme de mezcla?" icon="ui-icon-alert" />
                                        </p:commandButton>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </h:form>
                </p:dialog>
                
                <p:dialog header="CONFIRMACIÓN DE CANCELACIÓN"
                          widgetVar="mdlMotivoCancel"
                          closeOnEscape="true"
                          closable="true"
                          width="500px" 
                          modal="true" 
                          resizable="false"
                          responsive="true"
                          style="font-size:xx-small !important; " >
                    <h:form id="formCancelarSolucion"  >                        
                        <p:messages id="msgCancelar" showDetail="false" globalOnly="false" closable="true"  >
                            <p:autoUpdate />
                        </p:messages>

                        <div class="ui-g"  >
                            <div class="ui-g-12" >
                                <div class="ui-g-12 ui-md-6 ui-lg-12" >
                                    <p:outputLabel style="margin-right: 1px;" value="Seleccione el motivo: " />
                                    <p:selectOneMenu id="cmbJustificante" 
                                                     value="#{acondicionarSolucionesMB.solucion.idMotivoCancelacion}"   
                                                     autoWidth="true"  >
                                        <f:selectItem itemValue="#{null}" itemLabel="Seleccione una opción"  />
                                        <f:selectItem itemValue="#{1}" itemLabel="Alta de paciente"/>
                                        <f:selectItem itemValue="#{2}" itemLabel="Cambio de Tratamiento"/>
                                        <!--<f:selectItem itemValue="#{3}" itemLabel="Datos Incompletos"/>-->
                                        <!--<f:selectItem itemValue="#{17}" itemLabel="Cantidades insuficientes" />-->
                                        <!--<f:selectItem itemValue="#{14}" itemLabel="Condiciones de preparación incorrectas" />-->
                                        <!--<f:selectItem itemValue="#{15}" itemLabel="Condiciones de conservación incorrectas" />-->
                                        <f:selectItem itemValue="#{4}" itemLabel="Diagnóstico de alta"/>
                                        <f:selectItem itemValue="#{5}" itemLabel="Egreso de paciente"/>
                                        <!--<f:selectItem itemValue="#{6}" itemLabel="Error en preparación"/>-->
                                        <!--<f:selectItem itemValue="#{7}" itemLabel="Error en prescripción"/>-->
                                        <!--<f:selectItem itemValue="#{12}" itemLabel="Medicamento contaminado" />-->
                                        <!--<f:selectItem itemValue="#{13}" itemLabel="Medicamento caduco" />-->
                                        <!--<f:selectItem itemValue="#{8}" itemLabel="Mezcla inestable"/>-->
                                        <!--<f:selectItem itemValue="#{10}" itemLabel="Reacción de hipersensibilidad"/>-->
                                        <!--<f:selectItem itemValue="#{11}" itemLabel="Sospecha de RAM"/>-->
                                        <!--<f:selectItem itemValue="#{9}" itemLabel="Sospecha de evento Adverso"/>-->
                                        <f:selectItem itemValue="#{16}" itemLabel="Otro" />
                                        <p:ajax event="change" update=":formCancelarSolucion:txtCual"
                                                listener="#{acondicionarSolucionesMB.changeMotivo}" />   
                                    </p:selectOneMenu>
                                </div>
                            </div>

                            <div class="ui-g-12"  >
                                <div class="ui-g-12 ui-md-6 ui-lg-4"  style="margin:0px; padding: 0px;  width: 100%!important;">
                                    <p:outputLabel id="lblCual" style="margin-right: 1px;" value="¿Cual?: "  />
                                    <p:inputText id="txtCual" value="#{acondicionarSolucionesMB.solucion.motivoCancela}" 
                                                 size="35" readonly="#{acondicionarSolucionesMB.otro}" />
                                </div>
                            </div>

                            <div class="ui-g-12"  >
                                <div class="ui-g-12 ui-md-6 ui-lg-4"  style="margin:0px; padding: 0px;  width: 100%!important;">
                                    <p:outputLabel style="margin-right: 1px;" value="Comentarios: " /><br/>
                                    <p:inputTextarea  value="#{acondicionarSolucionesMB.solucion.comentariosCancelacion}" rows="2" cols="50"  />
                                </div>
                            </div>
                            <div class="ui-g-12"  >
                                <div class="ui-g-12 ui-md-6 ui-lg-4"  style="margin:0px; padding: 0px;  width: 100%!important;">
                                    <p:outputLabel value="Desea cancelar la orden de Preparación de la Mezcla ?" style="font-weight: bold;" />
                                </div>
                            </div>
                        </div>
                        <div class="ui-g-12" style=" width: 100% !important; /*position: absolute; bottom: 0px;*/ background-color: #f8f8f8; border-top: solid 2px #C8C8C8;  " >
                            <div class="ui-g-12 ui-md-6 ui-lg-6" style="display: flex; align-content: center; justify-content: space-between; float: right;" >
                                <div>
                                    <p:commandButton value="No"  
                                                     icon="fa fa-times-circle" style="margin-right: 1px;float: right;"
                                                     styleClass="btnMusBoolGris" 
                                                     onclick="PF('mdlMotivoCancel').hide();" /> 
                                </div>
                                <div>
                                    <p:commandButton id="btnConfirmaCancela" value="Si" 
                                                     icon="fa fa-check-circle" style="margin-right: 1px;float: right;"
                                                     styleClass="btnMusRed" 
                                                     onclick="PF('statusProcess').show()" 
                                                     actionListener="#{acondicionarSolucionesMB.cancelarSolucion}" 
                                                     oncomplete="PF('statusProcess').hide(); if(args.estatus){PF('mdlMotivoCancel').hide();PF('modalSurtimiento').hide();}"
                                                     update=":mainForm:tblSoluciones" > 
                                        <p:confirm header="Confirmación" message="Realmente desea cancelar la orden de mezcla ?" icon="ui-icon-alert" />
                                    </p:commandButton>
                                </div>
                            </div>
                        </div>
                    </h:form>
                </p:dialog>
                
                
                <p:dialog header="Impresión de Etiqueta" 
                          width="550" 
                          id="modalEtiqueta"
                          widgetVar="mdlPrint" 
                          closable="true"
                          closeOnEscape="true" 
                          modal="true"
                          style="font-size:xx-small !important;" >

                    <h:form id="frmPrintSelect">
                        <p:messages id="validaMsg1" globalOnly="false" closable="true" showDetail="false" >
                            <p:autoUpdate />
                        </p:messages>
                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" >
                            <p:commandButton value="Si" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                            <p:commandButton value="No" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                        </p:confirmDialog>

                        <p:panelGrid style="padding: 10px !important;" columns="2" >
                            <h:outputText value="Paciente : " />
                            <h:outputText style="width:400px; font-weight: bolder; "
                                          value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombrePaciente}"/>

                            <h:outputText value="Folio : " />
                            <h:outputText style="width:400px; font-weight: bolder; " 
                                          value="#{acondicionarSolucionesMB.claveMezcla}" />

                            <h:outputText value="Lote : " />
                            <h:outputText style="width:400px; font-weight: bolder; " 
                                          value="#{acondicionarSolucionesMB.loteMezcla}"/>

                            <h:outputText value="Caducidad Mezcla : " />
                            <h:outputText style="width:400px; font-weight: bolder; " 
                                          value="#{acondicionarSolucionesMB.caducidadMezcla}">
                                <f:convertDateTime type="date" pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </p:panelGrid>
                        <br/>
                        <p:panelGrid style="padding: 10px !important;" columns="2" >                                    
                            <h:outputText value="Tipo de Impresión : "/>
                            <p:selectOneMenu style="width:200px"
                                             value="#{acondicionarSolucionesMB.tipoArchivoImprimir}" >
<!--                                <f:selectItem itemLabel="Seleccione una opción" itemValue="# {null}" />-->
                                <f:selectItem itemLabel="Etiqueta" itemValue="#{acondicionarSolucionesMB.docEtiqueta}" />
                                <!--<f:selectItem itemLabel="Reporte" itemValue="# {acondicionarSolucionesMB.docReporte}" />-->
                                <p:ajax update="btnImpEtiq" listener="#{acondicionarSolucionesMB.activaImpresion}" />
                            </p:selectOneMenu>

                            <h:outputText value="Impresora : "/>
                            <p:selectOneMenu id="comboImpresora" style="width: 200px;"  
                                             value="#{acondicionarSolucionesMB.idPrintSelect}"  >
                                <f:selectItem itemLabel="Seleccione una opción" itemValue="# {null}" noSelectionOption="true"  />
                                <f:selectItems var="print" value="#{acondicionarSolucionesMB.listaImpresorasPorSolucion}"
                                               itemLabel="#{print.descripcion}" itemValue="#{print.idImpresora}" />
                                <p:ajax update="btnImpEtiq" listener="#{acondicionarSolucionesMB.activaImpresion}" />
                            </p:selectOneMenu>

                            <h:outputText value="Plantilla de impresión: " />
                            <p:selectOneMenu id="template" style="width: 200px;" value="#{acondicionarSolucionesMB.template}" >
                                <f:selectItem itemLabel="Seleccione una opción" itemValue="# {null}" noSelectionOption="true"  />
                                <f:selectItems var="temp" value="#{acondicionarSolucionesMB.templateListPorSolucion}" 
                                               itemValue="#{temp.idTemplate}" itemLabel="#{temp.nombre}" />
                                <p:ajax update="btnImpEtiq" listener="#{acondicionarSolucionesMB.activaImpresion}" />
                            </p:selectOneMenu>

                            <h:outputText value="No. Etiquetas a imprimir: "/>
                            <p:inputNumber size="4" id="catImp" 
                                           value="#{acondicionarSolucionesMB.cantPrint}" 
                                           inputStyle="text-align:right" decimalPlaces="0" decimalSeparator=","
                                           disabled="#{!acondicionarSolucionesMB.permiso.puedeAutorizar}" >
                                <p:ajax update="btnImpEtiq" event="change" listener="#{acondicionarSolucionesMB.activaImpresion}" />
                            </p:inputNumber>
                            
                            <h:outputText value="Motivo de Reimpresión: "
                                          rendered="#{acondicionarSolucionesMB.numeroImpresiones gt 0}" />
                            <p:inputText size="20" id="txtReimpresion" 
                                         value="#{acondicionarSolucionesMB.notas}" 
                                           rendered="#{acondicionarSolucionesMB.numeroImpresiones gt 0}" />

                        </p:panelGrid>

                        <p:panel class="pnlActions">
                            <p:commandButton id="btnTipCancel" class="btnItem" value="Cancelar"  style="width: 100px;" 
                                             actionListener="#{acondicionarSolucionesMB.cancelImprimirEtiqueta}"                                             
                                             ajax="true" onclick="PF('mdlPrint').hide();"  validateClient="false" />
                            <p:spacer width="10"/>
                            <p:commandButton id="btnImpEtiq" value="Imprimir" style="width:100px;" styleClass="btnMusAzul"
                                             disabled="#{!acondicionarSolucionesMB.imprimeEtiqueta}"
                                             actionListener="#{acondicionarSolucionesMB.imprimirEtiquetaItem}"
                                             onclick="PF('statusProcess').show();"
                                             oncomplete="if(args.estatus == true){PF('mdlPrint').hide();} PF('statusProcess').hide();"
                                             />

                        </p:panel>
                    </h:form>
                </p:dialog>
                
                <p:dialog header="Impresión de Etiqueta" width="350" id="modalEtiqueta2"
                          widgetVar="mdlPrint2" closable="true"
                          closeOnEscape="true" modal="true"                          
                          style="font-size:xx-small !important;" >
                    <h:form id="frmPrintSelect2">
                        <p:messages id="validaMsg2" globalOnly="false" closable="true" showDetail="false" >
                            <p:autoUpdate />
                        </p:messages>
                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" >
                            <p:commandButton value="Si" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                            <p:commandButton value="No" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                        </p:confirmDialog>
                        <p:panelGrid >
                            <p:row>
                                <h:outputText value="Paciente : " />
                                <h:outputText value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombrePaciente}"
                                    style="width:400px; font-weight: bolder; "  /><br/>
                            </p:row>
                            <p:row>
                                <h:outputText value="Folio : " />
                                <h:outputText value="#{acondicionarSolucionesMB.folioSolucion}"
                                    style="width:400px; font-weight: bolder; "  /><br/>
                            </p:row>
                            <p:row>
                                <h:outputText value="Lote : " />
                                <h:outputText 
                                    value="#{acondicionarSolucionesMB.loteSolucion}"
                                              style="width:400px; font-weight: bolder; "  /><br/>
                            </p:row>
                            <p:row>
                                <h:outputText value="Caducidad Solución : " />
                                <h:outputText 
                                    value="#{acondicionarSolucionesMB.caducidadSolucion}"
                                    style="width:400px; font-weight: bolder; "  >
                                    <f:convertDateTime type="date" pattern="dd/MM/yyyy"/>
                                </h:outputText>
                                <br/><br/>
                            </p:row>
                            
                            <p:row>
                                <h:outputText value="Documento a Imprimir : "/><br/>
                            </p:row>
                            <p:row>
                                <p:selectOneMenu  value="#{acondicionarSolucionesMB.tipoArchivoImprimir}" style="width:125px" ><font></font>                                    
                                    <f:selectItem itemLabel="Etiqueta" itemValue="#{acondicionarSolucionesMB.docEtiqueta}" /><font></font>
                                    <f:selectItem itemLabel="Reporte" itemValue="#{acondicionarSolucionesMB.docReporte}" /><font></font>                                    
                                    <p:ajax update="catImp,comboImpresora,btnTipNew,btnGenReporte" listener="#{acondicionarSolucionesMB.changeDoctoImpresora}" />
                                </p:selectOneMenu><br/><br/>
                            </p:row>
                            
                            <p:row>
                                <h:outputText value="Seleccione una impresora : "/><br/>
                            </p:row>
                            <p:row>
                                <p:selectOneMenu id="comboImpresora" disabled="#{acondicionarSolucionesMB.imprimeEtiqueta}" style="width: 290px;"  value="#{acondicionarSolucionesMB.idPrintSelect}"   tabindex="4"  >
                                    <f:selectItem itemLabel="Seleccione una opción" itemValue="#{null}" noSelectionOption="true"  />
                                    <f:selectItems  var="print" value="#{acondicionarSolucionesMB.listaImpresoras}"  itemLabel="#{print.descripcion}" 
                                                    itemValue="#{print.idImpresora}" />
                                    <p:ajax update="btnTipNew" listener="#{acondicionarSolucionesMB.changePrint}" />
                                </p:selectOneMenu><br/><br/>
                            </p:row>
                            <p:row rendered="#{acondicionarSolucionesMB.numTemp > 1 ? true : false}">
                                <h:outputText value="Seleccione un template: "  rendered="#{acondicionarSolucionesMB.numTemp > 1 ? true : false}" /><br/>
                            </p:row>
                            <p:row rendered="#{acondicionarSolucionesMB.numTemp > 1 ? true : false}">
                                <p:selectOneMenu id="template" style="width: 290px;"  value="#{acondicionarSolucionesMB.template}" tabindex="4" >
                                    <f:selectItem itemLabel="Seleccione una opción" itemValue="#{null}" noSelectionOption="true"  />
                                    <f:selectItems  var="temp" value="#{acondicionarSolucionesMB.templateList}"  itemLabel="#{temp.nombre}" 
                                                    itemValue="#{temp.contenido}" />
                                    <p:ajax update="btnTipNew" listener="#{acondicionarSolucionesMB.changePrint}" />
                                </p:selectOneMenu><br/><br/>
                            </p:row>
                            <p:row>
                                <h:outputText value="Etiquetas a imprimir: "/>&nbsp;&nbsp;
                            </p:row>
                            <p:row>
                                <p:inputNumber size="10" id="catImp" disabled="#{acondicionarSolucionesMB.imprimeEtiqueta}" value="#{acondicionarSolucionesMB.cantPrint}" inputStyle="text-align:right" decimalPlaces="0" decimalSeparator="," > 
                                    <p:ajax update="btnTipNew" event="change" listener="#{acondicionarSolucionesMB.changePrint}" />
                                </p:inputNumber>                                
                            </p:row>
                        </p:panelGrid>
                        <p:panel class="pnlActions">
                            <p:commandButton id="btnTipCancel" class="btnItem" value="Cancelar"  style="width: 80px;" 
                                             actionListener="#{acondicionarSolucionesMB.cancelImprimirEtiqueta}"                                             
                                             ajax="true" onclick="PF('mdlPrint').hide();"  validateClient="false" />                                                                            
                            
                             <p:commandButton id="btnGenReporte" disabled="#{acondicionarSolucionesMB.imprimeReporte}" class="btnItem" value="Reporte"
                                             styleClass="btnMusVerde" style="width: 80px;" 
                                             actionListener="#{acondicionarSolucionesMB.imprimirReporte}" 
                                             update="formPDF"
                                             onclick="PF('statusProcess').show()"                                
                                             oncomplete="PF('statusProcess').hide(); if (args.estatus) { PF('mdlPrint').hide(); PF('mdlReport').show();}"
                                             />
                             
                            <p:commandButton id="btnTipNew" disabled="#{!acondicionarSolucionesMB.activeBtnPrint or acondicionarSolucionesMB.imprimeEtiqueta}"
                                             value="Imprimir" style="margin:0; width: 80px; "
                                             actionListener="#{acondicionarSolucionesMB.imprimirEtiquetaItem}"
                                             onclick="PF('statusProcess').show();"
                                             styleClass="btnMusAzul"
                                             oncomplete="if(args.estatus == true){PF('mdlPrint').hide();} PF('statusProcess').hide();"
                                             />
                            
                        </p:panel>
                    </h:form>
                </p:dialog>
                
                <p:dialog header="ENTREGAR SOLUCIÓN"
                          widgetVar="modalEntregarSolucion"
                          closeOnEscape="true"
                          closable="true"
                          width="80%" 
                          modal="true" 
                          resizable="false"
                          responsive="true"
                          style="font-size:xx-small !important; " >

                    <h:form id="formSurtimientoDetailEntregar"  >                        
                        <p:messages id="msgValidaRegistro1" showDetail="false" globalOnly="false" closable="true" >
                                <p:autoUpdate />
                            </p:messages>
                        <div class="ui-g"  >
                            <div class="ui-g-12"  >
                                <div class="ui-g-12 ui-md-6 ui-lg-3"  >
                                    <p:outputLabel style="margin-right: 1px;">Folio Prescripción:</p:outputLabel>
                                    <br/>
                                    <p:outputLabel style="margin-right: 1px;" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.folioPrescripcion}"
                                                   class="textoNegrita lbl-subtitulo" />                                    
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3" >
                                    <p:outputLabel style="margin-right: 1px;" value="Folio Surtimiento:" />
                                    <br/>
                                    <p:outputLabel class="textoNegrita" style="margin-right: 1px;" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.folio}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3" >
                                    <p:outputLabel style="margin-right: 1px;" value="Fecha Programada:"/>
                                    <br/>
                                    <p:outputLabel  class="textoNegrita" style="margin-right: 1px;" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.fechaProgramada}">
                                        <f:convertDateTime type="date" pattern="dd/MM/yyyy" />
                                    </p:outputLabel>
                                </div>                                
                                <div class="ui-g-12 ui-md-6 ui-lg-2" >
                                    <p:outputLabel style="margin-right: 1px;" value="Tipo:" />
                                    <br/>                                                                        
                                    <p:outputLabel class="lbl-Tipo-PrescripcionNormal" value="Normal" rendered="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tipoPrescripcion eq 'N'}" />
                                    <p:outputLabel class="lbl-Tipo-PrescripcionUnica" value="Única" rendered="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tipoPrescripcion eq 'D'}" />
                                    <p:outputLabel class="lbl-Tipo-PrescripcionUrgente" value="Urgente" rendered="#{acondicionarSolucionesMB.surtimientoExtendedSelected.tipoPrescripcion eq 'U'}" />
                                </div> 
                            </div>
                        </div>
                                            
                        <div class="ui-g panelGris"  >
                            <div class="ui-g-12"   >
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <p:outputLabel style="margin-right: 1px;" value="Servicio:" />
                                    <br/>
                                    <p:outputLabel style="margin-right: 1px;" class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombreEstructura}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3">
                                    <i class="fa fa-bed" aria-hidden="true" />
                                    <br/>
                                    <p:outputLabel style="margin-right: 1px;" class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.cama}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-3" >
                                    <p:outputLabel style="margin-right: 1px;" value="Paciente: "/>
                                    <br/>
                                    <p:outputLabel style="margin-right: 1px;" class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.nombrePaciente}" />
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-2" >
                                    <p:outputLabel style="margin-right: 0px;" value="No. Paciente:" />
                                    <br/>
                                    <p:outputLabel style="margin-right: 0px;" class="textoNegrita" value="#{acondicionarSolucionesMB.surtimientoExtendedSelected.pacienteNumero}" />
                                </div>
                            </div>
                        </div>
                        
                        <p:dataTable id="tblInsumosEntrega" 
                                     widgetVar="tblInsumosEntrega" 
                                     value="#{acondicionarSolucionesMB.surtimientoInsumoExtendedList}"
                                     selection="#{acondicionarSolucionesMB.surtimientoInsumoExtendedSelected}"                                     
                                     var="item" 
                                     rowKey="#{item.idSurtimientoInsumo}"
                                     rowIndexVar="row"
                                     selectionMode="single"
                                     style="margin-bottom:5px;"
                                     styleClass="mystyle"
                                     scrollable="true" scrollHeight="250"
                                     emptyMessage="No se encontraron Registros"
                                     reflow="true"
                                     paginatorTemplate="{Records} {CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                                     currentPageReportTemplate=" "
                                     paginator="true"
                                     rows="10"  
                                     
                                     paginatorPosition="bottom"                                     
                                     disabledSelection="true" 
                                     rendered="#{acondicionarSolucionesMB.sizeSurtimientoInsumoExtendedList gt -1}" >                            
                            <f:facet name="{Records}">
                                <div style="float:left;">
                                    <p:outputLabel class="footerLabel" value="  Medicamentos Prescritos: #{acondicionarSolucionesMB.sizeSurtimientoInsumoExtendedList}" rendered="true" />
                                </div>
                            </f:facet>
                            <ui:remove>
                            <p:column style="width :3%">
                                <p:rowToggler />
                            </p:column>
                            </ui:remove>
                            <p:column style="text-align: left; width: 10% "
                                      sortBy="#{item.claveInstitucional}" >
                                <f:facet name="header" >
                                    <h:outputText value="Clave" />
                                </f:facet>
                                <h:outputText value="#{item.claveInstitucional}" class="textoNegrita" />
                            </p:column>
                            <p:column style="text-align: left; width: 37% "
                                      sortBy="#{item.nombreCorto}" >
                                <f:facet name="header" >
                                    <h:outputText value="Nombre" />
                                </f:facet>
                                <h:outputText value="#{item.nombreCorto}" title="#{item.nombreCorto}" class="limitText" />
                            </p:column>
                            <p:column style="text-align: left; width: 6% " >
                                <f:facet name="header" >
                                    <h:outputText value="Cantidad" />
                                </f:facet>
                                <h:outputText value="#{item.cantidadEnviada}" />
                            </p:column>
                            <p:column style="text-align: left; width: 10% " >
                                <f:facet name="header" >
                                    <h:outputText value="Lote" />
                                </f:facet>
                                <h:outputText value="#{item.lote}" class="textoNegrita" />
                            </p:column>
                            
                            <p:column style="text-align: left; width: 8% " >
                                <f:facet name="header" >
                                    <h:outputText value="Caducidad" />
                                </f:facet>
                                <h:outputText value="#{item.caducidad}" class="textoNegrita" > 
                                    <f:convertDateTime type="date" pattern="dd/MM/yyyy" />
                                </h:outputText>
                            </p:column>

                            <p:column style="text-align: left; width: 8% " >
                                <f:facet name="header" >
                                    <h:outputText value="Tipo" />
                                </f:facet>
                                <h:outputText value="#{item.nombreIngrediente}" class="textoNegrita" />
                            </p:column>
                        </p:dataTable>
                        <div class="ui-g"  >
                            <div class="ui-g-12"  >                                              
                                <div class="ui-g-12 ui-md-6 ui-lg-4"  >
                                    <p:outputLabel style="margin-right: 1px;" class="textoNegrita" value="Usuario Recibe: " />
                                    <p:autoComplete id="txtUsuario" 
                                                    styleClass="width: 250px !important;" 
                                                    panelStyle="width: 250px !important;" 
                                                    inputStyleClass="width: 250px !important;" 
                                                    value="#{acondicionarSolucionesMB.usrselected}"
                                                    completeMethod="#{acondicionarSolucionesMB.autocompleteUsuario}"
                                                    minQueryLength="4"
                                                    queryDelay="500" 
                                                    maxResults="50" 
                                                    forceSelection="true" 
                                                    cacheTimeout="0" 
                                                    var="usr" 
                                                    placeholder="Filtro Usuarios" 
                                                    cache="false"
                                                    emptyMessage="No se encontraron registros"
                                                    itemLabel="#{usr.nombreUsuario}" itemValue="#{usr}" 
                                                    converter="musGenericConverter"
                                                    scrollHeight = "350" 
                                                    disabled="#{acondicionarSolucionesMB.solucionSelect.idEstatusSolucion==6}">
                                        <p:column style="width: 80px; font-size: small;" width="20px">
                                            <f:facet name="header" >
                                                <h:outputText value="Nombre" />
                                            </f:facet>
                                            <h:outputText value="#{usr.nombreUsuario}" style=" font-size: small;" />
                                        </p:column>
                                        <p:column style="width: 80px; font-size: small;" width="20px">
                                            <f:facet name="header" >
                                                <h:outputText value="Nombre" />
                                            </f:facet>
                                            <h:outputText value="#{usr.nombre}" style=" font-size: small;" />
                                        </p:column>
                                        <p:column style="width:80px; font-size: small;" width="350px">
                                            <f:facet name="header" >
                                                <h:outputText value="Apellido Paterno" />
                                            </f:facet>
                                            <h:outputText value="#{usr.apellidoPaterno}" style=" font-size: small;" />
                                        </p:column>
                                        <p:column style="width: 80px; font-size: small;" width="350px">
                                            <f:facet name="header" >
                                                <h:outputText value="Apellido Materno" />
                                            </f:facet>
                                            <h:outputText value="#{usr.apellidoMaterno}" style=" font-size: small;" />
                                        </p:column>
                                    </p:autoComplete>
                                </div>
                                <div class="ui-g-12 ui-md-6 ui-lg-4"  >
                                    <p:outputLabel style="margin-right: 1px;" class="textoNegrita" value="Área Recibe: " />
                                    <p:selectOneMenu style="width: 150px;vertical-align: middle;margin-right: 1px;" value="#{acondicionarSolucionesMB.idSerivicioRecive}" 
                                                     filter="true" filterPlaceholder="Servicio Recibir" disabled="#{acondicionarSolucionesMB.solucionSelect.idEstatusSolucion==6}" >   
                                        <f:selectItem itemLabel="Seleccionar un servicio" itemValue="#{null}" />
                                        <f:selectItems value="#{acondicionarSolucionesMB.listaEstructurasRecibir}" var="estructura" itemLabel="#{estructura.nombre}" itemValue="#{estructura.idEstructura}" />                                
                                    </p:selectOneMenu>
                                </div>
                                <ui:remove><div class="ui-g-12 ui-md-6 ui-lg-6"  >
                                    <p:outputLabel style="margin-right: 1px;" value="Comentarios: " />
                                    <p:inputTextarea  value="#{acondicionarSolucionesMB.comentarios}" rows="1" cols="60" autoResize="false" 
                                                      disabled="#{acondicionarSolucionesMB.solucionSelect.idEstatusSolucion==6}"/>
                                </div>    </ui:remove>
                            </div>
                            <div class="ui-g-12"  >
                                <div class="ui-g-12 ui-md-6 ui-lg-8"  >
                                    <p:outputLabel style="margin-right: 1px;" class="textoNegrita" value="Comentarios: " />
                                    <p:inputTextarea  value="#{acondicionarSolucionesMB.comentarios}" rows="3" cols="100" autoResize="false" 
                                                      disabled="#{acondicionarSolucionesMB.solucionSelect.idEstatusSolucion==6}"/>
                                </div>
                            </div>
                        </div>    
                        <br />
                        <p:commandButton value="Entregar" rendered="#{acondicionarSolucionesMB.solucionSelect.idEstatusSolucion==5}"                                                                                   
                                         icon="fa fa-check-circle" style="margin-right: 20px;float: right;"
                                         onclick="PF('statusProcess').show()" 
                                         oncomplete="PF('statusProcess').hide(); if (args.estatus){PF('modalEntregarSolucion').hide();}"
                                         actionListener="#{acondicionarSolucionesMB.entregarMezcla()}"
                                         styleClass="btnMusAzul" update=":mainForm:validaMsg, :mainForm:tblSoluciones" > 
                            <p:confirm header="Correcta" message="¿Está seguro de entregar la solución?" icon="ui-icon-alert" />
                        </p:commandButton>
                        
                        <p:commandButton value="Cerrar" icon="fa fa-times-circle"  onclick="PF('modalEntregarSolucion').hide();"
                                         style="margin-right: 20px;float: right;" /> 
                        
                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                            <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                        </p:confirmDialog>

                    </h:form>
                </p:dialog>
                
                <p:dialog widgetVar="mdlReport" width="820px" height="600px"
                          closeOnEscape="false" modal="true"                          
                          style="font-size:xx-small !important;" >
                    <h:form id="formPDF">
                        <p:media value="/Reportes" player="pdf" width="800px" height="600px" cache="false" />
                    </h:form>
                    <p:ajax event="close" listener="#{sesionMB.freeBytesFromSession()}"/>
                </p:dialog>
            </ui:define>
        </ui:composition>
    </h:body>
</html>