<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="mx.mc.mapper.ReaccionMapper" >
    <insert id="insertar" parameterType="mx.mc.model.Reaccion" >
        INSERT INTO reaccion (
        <if test=" idReaccion != null ">
            idReaccion
        </if>
        <if test=" folio != null ">
            ,folio
        </if>
        <if test=" numeroNotificacion != null ">
            ,numeroNotificacion
        </if>
        <if test=" fecha != null ">
            ,fecha
        </if>
        <if test=" idEstatusReaccion != null ">
            ,idEstatusReaccion
        </if>
        <if test=" rfcPaciente != null ">
            ,rfcPaciente
        </if>
        <if test=" curpPaciente != null ">
            ,curpPaciente
        </if>
        <if test=" idPaciente != null ">
            ,idPaciente
        </if>
        <if test=" numeroPaciente != null ">
            ,numeroPaciente
        </if>
        <if test=" nombrePaciente != null ">
            ,nombrePaciente
        </if>
        <if test=" fechaNacimiento != null ">
            ,fechaNacimiento
        </if>
        <if test=" edad != null ">
            ,edad
        </if>
        <if test=" sexo != null ">
            ,sexo
        </if>
        <if test=" peso != null ">
            ,peso
        </if>
        <if test=" estatura != null ">
            ,estatura
        </if>
        <if test=" fechaInicioSospecha != null ">
            ,fechaInicioSospecha
        </if>
        <if test=" idTipoReaccion != null ">
            ,idTipoReaccion
        </if>
        <if test=" idConsecuencia != null ">
            ,idConsecuencia
        </if>
        <if test=" descripcion != null ">
            ,descripcion
        </if>
        <if test=" idInsumo != null ">
            ,idInsumo
        </if>
        <if test=" medicamento != null ">
            ,medicamento
        </if>
        <if test=" clave != null ">
            ,clave
        </if>
        <if test=" idSustanciaActiva != null ">
            ,idSustanciaActiva
        </if>
        <if test=" sustanciaActiva != null ">
            ,sustanciaActiva
        </if>
        <if test=" viaAdministracion != null ">
            ,viaAdministracion
        </if>
        <if test=" lote != null ">
            ,lote
        </if>
        <if test=" caducidad != null ">
            ,caducidad
        </if>
        <if test=" laboratorio != null ">
            ,laboratorio
        </if>
        <if test=" denomincacionDistintiva != null ">
            ,denomincacionDistintiva
        </if>
        <if test=" dosis != null ">
            ,dosis
        </if>
        <if test=" unidad != null ">
            ,unidad
        </if>
        <if test=" frecuencia != null ">
            ,frecuencia
        </if>
        <if test=" duracion != null ">
            ,duracion
        </if>
        <if test=" motivoPrescripcion != null ">
            ,motivoPrescripcion
        </if>
        <if test=" inicioAdministracion != null ">
            ,inicioAdministracion
        </if>
        <if test=" finAdministracion != null ">
            ,finAdministracion
        </if>
        <if test=" medicamentoSuspendido != null ">
            ,medicamentoSuspendido
        </if>
        <if test=" desaparecioReaccion != null ">
            ,desaparecioReaccion
        </if>
        <if test=" disminuyoDosis != null ">
            ,disminuyoDosis
        </if>
        <if test=" cuanto != null ">
            ,cuanto
        </if>
        <if test=" cambioFarmacoTerapia != null ">
            ,cambioFarmacoTerapia
        </if>
        <if test=" cual != null ">
            ,cual
        </if>
        <if test=" reaparecioReaccionReadministrar != null ">
            ,reaparecioReaccionReadministrar
        </if>
        <if test=" persistioReaccion != null ">
            ,persistioReaccion
        </if>
        <if test=" historiaClinica != null ">
            ,historiaClinica
        </if>
        <if test=" tipoInformeLab != null ">
            ,tipoInformeLab
        </if>
        <if test=" origenLab != null ">
            ,origenLab
        </if>
        <if test=" tipoInformeProf != null ">
            ,tipoInformeProf
        </if>
        <if test=" origenProf != null ">
            ,origenProf
        </if>
        <if test=" rfcInformante != null ">
            ,rfcInformante
        </if>
        <if test=" curpInformante != null ">
            ,curpInformante
        </if>
        <if test=" numeroInformante != null ">
            ,numeroInformante
        </if>
        <if test=" cedula != null ">
            ,cedula
        </if>
        <if test=" nombre != null ">
            ,nombre
        </if>
        <if test=" apellidoPat != null ">
            ,apellidoPat
        </if>
        <if test=" apellidoMat != null ">
            ,apellidoMat
        </if>
        <if test=" telefono != null ">
            ,telefono
        </if>
        <if test=" correoElectronico != null ">
            ,correoElectronico
        </if>
        <if test=" calle != null ">
            ,calle
        </if>
        <if test=" numeroExt != null ">
            ,numeroExt
        </if>
        <if test=" numeroInt != null ">
            ,numeroInt
        </if>
        <if test=" colonia != null ">
            ,colonia
        </if>
        <if test=" localidad != null ">
            ,localidad
        </if>
        <if test=" municipio != null ">
            ,municipio
        </if>
        <if test=" estado != null ">
            ,estado
        </if>
        <if test=" pais != null ">
            ,pais
        </if>
        <if test=" cp != null ">
            ,cp
        </if>
        <if test=" publicarInformacion != null ">
            ,publicarInformacion
        </if>
        <if test=" riesgo != null ">
            ,riesgo
        </if>
        <if test=" insertFecha != null ">
            ,insertFecha
        </if>
        <if test=" insertIdUsuario != null ">
            ,insertIdUsuario
        </if>
        <if test=" updateFecha != null ">
            ,updateFecha
        </if>
        <if test=" updateIdUsuario != null ">
            ,updateIdUsuario
        </if>
        ) VALUES (
        <if test = "idReaccion != null">
            #{idReaccion}
        </if>
        <if test = "folio != null">
            ,#{folio}
        </if>
        <if test = "numeroNotificacion != null">
            ,#{numeroNotificacion}
        </if>
        <if test = "fecha != null">
            ,#{fecha}
        </if>
        <if test = "idEstatusReaccion != null">
            ,#{idEstatusReaccion}
        </if>
        <if test = "rfcPaciente != null">
            ,#{rfcPaciente}
        </if>
        <if test = "curpPaciente != null">
            ,#{curpPaciente}
        </if>
        <if test = "idPaciente != null">
            ,#{idPaciente}
        </if>
        <if test = "numeroPaciente != null">
            ,#{numeroPaciente}
        </if>
        <if test = "nombrePaciente != null">
            ,#{nombrePaciente}
        </if>
        <if test = "fechaNacimiento != null">
            ,#{fechaNacimiento}
        </if>
        <if test = "edad != null">
            ,#{edad}
        </if>
        <if test = "sexo != null">
            ,#{sexo}
        </if>
        <if test = "peso != null">
            ,#{peso}    
        </if>
        <if test = "estatura != null">
            ,#{estatura}
        </if>
        <if test = "fechaInicioSospecha != null">
            ,#{fechaInicioSospecha}
        </if>
        <if test = "idTipoReaccion != null">
            ,#{idTipoReaccion}
        </if>
        <if test = "idConsecuencia != null">
            ,#{idConsecuencia}
        </if>
        <if test = "descripcion != null">
            ,#{descripcion}
        </if>
        <if test = "idInsumo != null">
            ,#{idInsumo}
        </if>
        <if test = "medicamento != null">
            ,#{medicamento}
        </if>
        <if test = "clave != null">
            ,#{clave}
        </if>
        <if test = "idSustanciaActiva != null">
            ,#{idSustanciaActiva}
        </if>
        <if test = "sustanciaActiva != null">
            ,#{sustanciaActiva}
        </if>
        <if test = "viaAdministracion != null">
            ,#{viaAdministracion}
        </if>
        <if test = "lote != null">
            ,#{lote}
        </if>
        <if test = "caducidad != null">
            ,#{caducidad}
        </if>
        <if test = "laboratorio != null">
            ,#{laboratorio}
        </if>
        <if test = "denomincacionDistintiva != null">
            ,#{denomincacionDistintiva}
        </if>
        <if test = "dosis != null">
            ,#{dosis}
        </if>
        <if test = "unidad != null">
            ,#{unidad}
        </if>
        <if test = "frecuencia != null">
            ,#{frecuencia}
        </if>
        <if test = "duracion != null">
            ,#{duracion}
        </if>
        <if test = "motivoPrescripcion != null">
            ,#{motivoPrescripcion}
        </if>
        <if test = "inicioAdministracion != null">
            ,#{inicioAdministracion}
        </if>
        <if test = "finAdministracion != null">
            ,#{finAdministracion}
        </if>
        <if test = "medicamentoSuspendido != null">
            ,#{medicamentoSuspendido}
        </if>
        <if test = "desaparecioReaccion != null">
            ,#{desaparecioReaccion}
        </if>
        <if test = "disminuyoDosis != null">
            ,#{disminuyoDosis}
        </if>
        <if test = "cuanto != null">
            ,#{cuanto}
        </if>
        <if test = "cambioFarmacoTerapia != null">
            ,#{cambioFarmacoTerapia}
        </if>
        <if test = "cual != null">
            ,#{cual}
        </if>
        <if test = "reaparecioReaccionReadministrar != null">
            ,#{reaparecioReaccionReadministrar}
        </if>
        <if test = "persistioReaccion != null">
            ,#{persistioReaccion}
        </if>
        <if test = "historiaClinica != null">
            ,#{historiaClinica}
        </if>
        <if test = "tipoInformeLab != null">
            ,#{tipoInformeLab}
        </if>
        <if test = "origenLab != null">
            ,#{origenLab}
        </if>
        <if test = "tipoInformeProf != null">
            ,#{tipoInformeProf}
        </if>
        <if test = "origenProf != null">
            ,#{origenProf}
        </if>
        <if test = "rfcInformante != null">
            ,#{rfcInformante}
        </if>
        <if test = "curpInformante != null">
            ,#{curpInformante}
        </if>
        <if test = "numeroInformante != null">
            ,#{numeroInformante}
        </if>
        <if test = "cedula != null">
            ,#{cedula}
        </if>
        <if test = "nombre != null">
            ,#{nombre}
        </if>
        <if test = "apellidoPat != null">
            ,#{apellidoPat}
        </if>
        <if test = "apellidoMat != null">
            ,#{apellidoMat}
        </if>
        <if test = "telefono != null">
            ,#{telefono}
        </if>
        <if test = "correoElectronico != null">
            ,#{correoElectronico}
        </if>
        <if test = "calle != null">
            ,#{calle}
        </if>
        <if test = "numeroExt != null">
            ,#{numeroExt}
        </if>
        <if test = "numeroInt != null">
            ,#{numeroInt}
        </if>
        <if test = "colonia != null">
            ,#{colonia}
        </if>
        <if test = "localidad != null">
            ,#{localidad}
        </if>
        <if test = "municipio != null">
            ,#{municipio}
        </if>
        <if test = "estado != null">
            ,#{estado}
        </if>
        <if test = "pais != null">
            ,#{pais}
        </if>
        <if test = "cp != null">
            ,#{cp}
        </if>
        <if test = "publicarInformacion != null">
            ,#{publicarInformacion}
        </if>
        <if test=" riesgo != null ">
            ,#{riesgo}
        </if>
        <if test = "insertFecha != null">
            ,#{insertFecha}
        </if>
        <if test = "insertIdUsuario != null">
            ,#{insertIdUsuario}
        </if>
        <if test = "updateFecha != null">
            ,#{updateFecha}
        </if>
        <if test = "updateIdUsuario != null">
            ,#{updateIdUsuario}
        </if>);
    </insert>
    
    <update id="actualizar" parameterType="mx.mc.model.Reaccion" >
        UPDATE reaccion
        SET
        <if test = "idReaccion != null">idReaccion = #{idReaccion}</if>
        <if test = "folio != null">,folio = #{folio} </if>
        <if test = "numeroNotificacion != null">,numeroNotificacion = #{numeroNotificacion}</if>
        <if test = "fecha != null">,fecha = #{fecha} </if>
        <if test = "idEstatusReaccion != null">,idEstatusReaccion = #{idEstatusReaccion} </if>
        <if test = "rfcPaciente != null">,rfcPaciente = #{rfcPaciente}</if>
        <if test = "curpPaciente != null">,curpPaciente = #{curpPaciente} </if>
        <if test = "idPaciente != null">,idPaciente = #{idPaciente}</if>
        <if test = "numeroPaciente != null">,numeroPaciente = #{numeroPaciente}</if>
        <if test = "nombrePaciente != null">,nombrePaciente = #{nombrePaciente}</if>
        <if test = "fechaNacimiento != null">,fechaNacimiento = #{fechaNacimiento}</if>
        <if test = "edad != null">,edad = #{edad}</if>
        <if test = "sexo != null">,sexo = #{sexo}</if>
        <if test = "peso != null">,peso = #{peso}</if>
        <if test = "estatura != null">,estatura = #{estatura}</if>
        <if test = "fechaInicioSospecha != null">,fechaInicioSospecha = #{fechaInicioSospecha}</if>
        <if test = "idTipoReaccion != null">,idTipoReaccion = #{idTipoReaccion}</if>
        <if test = "idConsecuencia != null">,idConsecuencia = #{idConsecuencia}</if>
        <if test = "descripcion != null">,descripcion = #{descripcion}</if>
        <if test = "idInsumo != null">,idInsumo = #{idInsumo}</if>
        <if test = "medicamento != null">,medicamento = #{medicamento}</if>
        <if test = "clave != null">,clave = #{clave}</if>
        <if test = "idSustanciaActiva != null">,idSustanciaActiva = #{idSustanciaActiva}</if>
        <if test = "sustanciaActiva != null">,sustanciaActiva = #{sustanciaActiva}</if>
        <if test = "viaAdministracion != null">,viaAdministracion = #{viaAdministracion}</if>
        <if test = "lote != null">,lote = #{lote}</if>
        <if test = "caducidad != null">,caducidad = #{caducidad}</if>
        <if test = "laboratorio != null">,laboratorio = #{laboratorio}</if>
        <if test = "denomincacionDistintiva != null">,denomincacionDistintiva = #{denomincacionDistintiva}</if>
        <if test = "dosis != null">,dosis = #{dosis}</if>
        <if test = "unidad != null">,unidad = #{unidad}</if>
        <if test = "frecuencia != null">,frecuencia = #{frecuencia}</if>
        <if test = "duracion != null">,duracion = #{duracion}</if>
        <if test = "motivoPrescripcion != null">,motivoPrescripcion = #{motivoPrescripcion}</if>
        <if test = "inicioAdministracion != null">,inicioAdministracion = #{inicioAdministracion}</if>
        <if test = "finAdministracion != null">,finAdministracion = #{finAdministracion}</if>
        <if test = "medicamentoSuspendido != null">,medicamentoSuspendido = #{medicamentoSuspendido}</if>
        <if test = "desaparecioReaccion != null">,desaparecioReaccion = #{desaparecioReaccion}</if>
        <if test = "disminuyoDosis != null">,disminuyoDosis = #{disminuyoDosis}</if>
        <if test = "cuanto != null">,cuanto = #{cuanto}</if>
        <if test = "cambioFarmacoTerapia != null">,cambioFarmacoTerapia = #{cambioFarmacoTerapia}</if>
        <if test = "cual != null">,cual = #{cual}</if>
        <if test = "reaparecioReaccionReadministrar != null">,reaparecioReaccionReadministrar = #{reaparecioReaccionReadministrar}</if>
        <if test = "persistioReaccion != null">,persistioReaccion = #{persistioReaccion}</if>
        <if test = "historiaClinica != null">,historiaClinica = #{historiaClinica}</if>
        <if test = "tipoInformeLab != null">,tipoInformeLab = #{tipoInformeLab}</if>
        <if test = "origenLab != null">,origenLab = #{origenLab}</if>
        <if test = "tipoInformeProf != null">,tipoInformeProf = #{tipoInformeProf}</if>
        <if test = "origenProf != null">,origenProf = #{origenProf}</if>
        <if test = "rfcInformante != null">,rfcInformante = #{rfcInformante}</if>
        <if test = "curpInformante != null">,curpInformante = #{curpInformante}</if>
        <if test = "numeroInformante != null">,numeroInformante = #{numeroInformante}</if>
        <if test = "cedula != null">,cedula = #{cedula}</if>
        <if test = "nombre  != null">,nombre = #{nombre}</if>
        <if test = "apellidoPat != null">,apellidoPat = #{apellidoPat}</if>
        <if test = "apellidoMat != null">,apellidoMat = #{apellidoMat}</if>
        <if test = "telefono != null">,telefono = #{telefono}</if>
        <if test = "correoElectronico != null">,correoElectronico = #{correoElectronico}</if>
        <if test = "calle != null">,calle = #{calle}</if>
        <if test = "numeroExt != null">,numeroExt = #{numeroExt}</if>
        <if test = "numeroInt != null">,numeroInt = #{numeroInt}</if>
        <if test = "colonia != null">,colonia = #{colonia}</if>
        <if test = "localidad != null">,localidad = #{localidad}</if>
        <if test = "municipio != null">,municipio = #{municipio}</if>
        <if test = "estado != null">,estado = #{estado}</if>
        <if test = "pais != null">,pais = #{pais}</if>
        <if test = "cp != null">,cp = #{cp}</if>
        <if test = "publicarInformacion != null">,publicarInformacion = #{publicarInformacion}</if>
        <if test = "riesgo != null">,riesgo = #{riesgo}</if>
        <if test = "updateFecha != null">,updateFecha = #{updateFecha}</if>
        <if test = "updateIdUsuario != null">,updateIdUsuario = #{updateIdUsuario}</if>        
        WHERE idReaccion = #{idReaccion};
        
    </update>
    
    <select id="obtener" resultType="mx.mc.model.Reaccion" parameterType="mx.mc.model.Reaccion" >
        SELECT idReaccion,
            folio,
            numeroNotificacion,
            fecha,
            idEstatusReaccion,
            rfcPaciente,
            curpPaciente,
            idPaciente,
            numeroPaciente,
            nombrePaciente,
            fechaNacimiento,
            edad,
            sexo,
            peso,
            estatura,
            fechaInicioSospecha,
            idTipoReaccion,
            idConsecuencia,
            descripcion,
            idInsumo,
            medicamento,
            clave,
            idSustanciaActiva,
            sustanciaActiva,
            viaAdministracion,
            lote,
            caducidad,
            laboratorio,
            denomincacionDistintiva,
            dosis,
            unidad,
            frecuencia,
            duracion,
            motivoPrescripcion,
            inicioAdministracion,
            finAdministracion,
            medicamentoSuspendido,
            desaparecioReaccion,
            disminuyoDosis,
            cuanto,
            cambioFarmacoTerapia,
            cual,
            reaparecioReaccionReadministrar,
            persistioReaccion,
            historiaClinica,
            tipoInformeLab,
            origenLab,
            tipoInformeProf,
            origenProf,
            rfcInformante,
            curpInformante,
            numeroInformante,
            cedula,
            nombre,
            apellidoPat,
            apellidoMat,
            telefono,
            correoElectronico,
            calle,
            numeroExt,
            numeroInt,
            colonia,
            localidad,
            municipio,
            estado,
            pais,
            cp,
            publicarInformacion,
            riesgo,
            insertFecha,
            insertIdUsuario,
            updateFecha,
            updateIdUsuario
        FROM reaccion
        WHERE 1=1
        <if test = "idReaccion != null">AND idReaccion = #{idReaccion}</if>;
    </select>
        
    <select id="obtenerReaccionesListLazy" resultType="mx.mc.model.ReaccionExtend" parameterType="Map" >
        SELECT             
            e.idEstatusReaccion,
            t.idTipoReaccion,
            r.viaAdministracion as idViaAdministracion,
            v.nombreViaAdministracion AS viaAdministracion,
            r.tipoInformeLab as idTipoInformeLab,
            r.tipoInformeProf as idTipoInformeProf,
            r.origenLab as idOrigenLab,
            r.origenProf as idOrigenProf,
            t.reaccion as tipo,
            CONCAT(r.nombre,' ', r.apellidoPat,' ', r.apellidoMat) AS registro,
            r.medicamento as insumo,
            e.descripcion AS estatus,
            r.*
        FROM    reaccion r
            INNER JOIN  tipoReaccion t ON t.idTipoReaccion = r.idTipoReaccion
            INNER JOIN  estatusReaccion e ON e.idEstatusReaccion = r.idEstatusReaccion
            INNER JOIN 	viaAdministracion v ON v.idViaAdministracion = r.viaAdministracion	
        WHERE 1=1
        <if test = 'paramBusquedaReporte.cadenaBusqueda != null '>
            AND (
                r.folio LIKE '%${paramBusquedaReporte.cadenaBusqueda}%'
                OR r.nombrePaciente LIKE '%${paramBusquedaReporte.cadenaBusqueda}%'
                OR r.medicamento LIKE '%${paramBusquedaReporte.cadenaBusqueda}%'
                OR e.descripcion LIKE '%${paramBusquedaReporte.cadenaBusqueda}%'
            )
        </if>
        <if test = 'estatusReaccionAdv != 0 '>
            AND r.idEstatusReaccion = #{estatusReaccionAdv}
        </if>
        <if test="sortOrder != null" > 
            <if test="sortField == 'fecha'" > 
                <if test="sortOrder == 'asc'" > 
                    ORDER BY r.fecha asc
                </if>
                <if test="sortOrder == 'desc'" > 
                    ORDER BY r.fecha desc
                </if>
            </if>  
            <if test="sortField == 'tipo'" > 
                <if test="sortOrder == 'asc'" > 
                    ORDER BY t.reaccion asc
                </if>
                <if test="sortOrder == 'desc'" > 
                    ORDER BY t.reaccion desc
                </if>
            </if>
            <if test="sortField == 'folio'" > 
                <if test="sortOrder == 'asc'" > 
                    ORDER BY r.folio asc
                </if>
                <if test="sortOrder == 'desc'" > 
                    ORDER BY r.folio desc
                </if>            
            </if> 
            <if test="sortField == 'nombrePaciente'" > 
                <if test="sortOrder == 'asc'" > 
                    ORDER BY r.nombrePaciente asc
                </if>
                <if test="sortOrder == 'desc'" > 
                    ORDER BY r.nombrePaciente desc
                </if>
            </if>
             <if test="sortField == 'registro'" > 
                <if test="sortOrder == 'asc'" > 
                    ORDER BY registro asc
                </if>
                <if test="sortOrder == 'desc'" > 
                    ORDER BY registro desc
                </if>
            </if>
             <if test="sortField == 'insumo'" > 
                <if test="sortOrder == 'asc'" > 
                    ORDER BY insumo asc
                </if>
                <if test="sortOrder == 'desc'" > 
                    ORDER BY insumo desc
                </if>
            </if>
             <if test="sortField == 'estatus'" > 
                <if test="sortOrder == 'asc'" > 
                    ORDER BY estatus asc
                </if>
                <if test="sortOrder == 'desc'" > 
                    ORDER BY estatus desc
                </if>
            </if>
            <if test="sortField == null" > 
                ORDER BY r.fecha desc
            </if>            
        </if>
        <if test="maxPerPage != -1">
            LIMIT #{startingAt}, #{maxPerPage}
        </if>
        ;
    </select>
       
    <select id="obtenerTotalReaccionesListLazy" resultType="Long" parameterType="Map" >
        SELECT 
            count(*)
        FROM    reaccion r
            INNER JOIN    tipoReaccion t ON t.idTipoReaccion = r.idTipoReaccion
            INNER JOIN    estatusReaccion e ON e.idEstatusReaccion = r.idEstatusReaccion
        WHERE 1=1
        <if test = 'paramBusquedaReporte.cadenaBusqueda != null '>
            AND (
                r.folio LIKE '%${ paramBusquedaReporte.cadenaBusqueda }%'
                OR r.nombrePaciente LIKE '%${ paramBusquedaReporte.cadenaBusqueda }%'
                OR r.medicamento LIKE '%${ paramBusquedaReporte.cadenaBusqueda }%'
                OR e.descripcion LIKE '%${ paramBusquedaReporte.cadenaBusqueda }%'
            )
        </if>
        <if test = 'estatusReaccionAdv != 0 '>
            AND r.idEstatusReaccion  = #{estatusReaccionAdv}
        </if>
    </select>
    
    <select id="obtenerReaccionesByIdPacienteIdInsumos" parameterType="Map" resultType="mx.mc.model.ReaccionExtend">
        select r.nombrePaciente, r.medicamento, tr.reaccion as tipo, r.riesgo 
        from reaccion r 
        INNER JOIN paciente p ON r.idPaciente = p.idPaciente
        INNER JOIN medicamento m ON r.idInsumo = m.idMedicamento
        INNER JOIN tipoReaccion tr ON r.idTipoReaccion = tr.idTipoReaccion
        WHERE 1= 1
        AND r.idPaciente = #{idPaciente, jdbcType = VARCHAR}
        <if test=" listaInsumos != null ">
            AND r.idInsumo IN
            <foreach item="item" index="index" collection="listaInsumos" open="(" separator="," close=")">           
                    #{item}
            </foreach>
        </if>
    </select>
</mapper>