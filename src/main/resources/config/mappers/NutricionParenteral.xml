<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="mx.mc.mapper.NutricionParenteralMapper" >

    <insert id="insertar" parameterType="mx.mc.model.NutricionParenteral" >
        INSERT INTO nutricionParenteral (
        <if test=" idNutricionParenteral != null"> idNutricionParenteral </if>
        <if test=" folio != null"> ,folio </if>
        <if test=" folioPreparacion != null"> ,folioPreparacion </if>
        <if test=" idEstructura != null"> ,idEstructura </if>
        <if test=" idPaciente != null"> ,idPaciente </if>
        <if test=" idEstatusSolucion != null"> ,idEstatusSolucion </if>
        <if test=" fechaPrepara != null"> ,fechaPrepara </if>
        <if test=" idRegistro != null"> ,idRegistro </if>
        <if test=" fechaProgramada != null"> ,fechaProgramada </if>
        <if test=" idMedico != null"> ,idMedico </if>
        <if test=" idVisita != null"> ,idVisita </if>
        <if test=" fechaIngreso != null"> ,fechaIngreso </if>
        <if test=" volumenTotal != null"> ,volumenTotal </if>
        <if test=" pesoTotal != null"> ,pesoTotal </if>
        <if test=" caloriasTotal != null"> ,caloriasTotal </if>
        <if test=" calcPesoVolumen != null"> ,calcPesoVolumen </if>
        <if test=" porcenEnergiaTotal != null"> ,porcenEnergiaTotal </if>
        <if test=" monovalentes != null"> ,monovalentes </if>
        <if test=" divalentes != null"> ,divalentes </if>
        <if test=" calcMonovalente != null"> ,calcMonovalente </if>
        <if test=" calcDivalente != null"> ,calcDivalente </if>
        <if test=" precipitacion != null"> ,precipitacion </if>
        <if test=" resultPrecipitacion != null"> ,resultPrecipitacion </if>
        <if test=" estabilidad != null"> ,estabilidad </if>
        <if test=" resultEstabilidad != null"> ,resultEstabilidad </if>
        <if test=" totalOsmolaridad != null"> ,totalOsmolaridad </if>
        <if test=" resulOsmolaridad != null"> ,resulOsmolaridad </if>
        <if test=" infusion != null"> ,infusion </if>
        <if test=" velocInfusion != null"> ,velocInfusion </if>
        <if test=" insertFecha != null "> ,insertFecha </if>
        <if test=" insertIdUsuario != null "> ,insertIdUsuario </if>
        <if test=" updateFecha != null "> ,updateFecha </if>
        <if test=" updateIdUsuario != null "> ,updateIdUsuario </if>
        <if test=" idSurtimiento != null"> ,idSurtimiento </if> 
        <if test=" edad != null"> ,edad </if>   
        <if test=" peso != null"> ,peso </if>
        <if test=" diagnosticos != null"> ,diagnosticos</if>
        <if test=" fechaNacimiento != null"> , fechaNacimiento </if>
                <if test=" tallaPaciente != null"> , tallaPaciente </if>
                <if test=" areaCorporal != null"> , areaCorporal </if>
                <if test=" tipoConsulta != null"> , tipoConsulta </if>
                <if test=" diabetes != null"> , diabetes </if>
                <if test=" problemasRenales != null"> , problemasRenales </if>
                <if test=" hipertension != null"> , hipertension </if>
                <if test=" idContenedor != null"> , idContenedor </if>
                <if test=" fechaParaEntregar != null"> , fechaParaEntregar </if>
                <if test=" idHorarioParaEntregar != null"> , idHorarioParaEntregar </if>
                <if test=" perfusionContinua != null"> , perfusionContinua </if>
                <if test=" velocidad != null"> , velocidad </if>
                <if test=" tipoPrescripcion != null"> , tipoPrescripcion </if>
                <if test=" padecimientoCronico != null"> , padecimientoCronico </if>
                <if test=" idCama != null"> , idCama </if>
                <if test=" idTipoSolucion != null"> , idTipoSolucion </if>
                <if test=" idViaAdministracion != null"> , idViaAdministracion </if>
                <if test=" sobrellenado != null"> , sobrellenado </if>
                <if test=" horasInfusion != null"> , horasInfusion </if>
                
                <if test=" kcalProteicas != null"> , kcalProteicas </if>
                <if test=" kcalNoProteicas != null"> , kcalNoProteicas </if>
                
        ) VALUES (
        <if test=" idNutricionParenteral != null"> #{idNutricionParenteral} </if>
        <if test=" folio != null"> ,#{folio} </if>
        <if test=" folioPreparacion != null"> ,#{folioPreparacion} </if>
        <if test=" idEstructura != null"> ,#{idEstructura} </if>
        <if test=" idPaciente != null"> ,#{idPaciente} </if>
        <if test=" idEstatusSolucion != null"> ,#{idEstatusSolucion} </if>
        <if test=" fechaPrepara != null"> ,#{fechaPrepara} </if>
        <if test=" idRegistro != null"> ,#{idRegistro} </if>
        <if test=" fechaProgramada != null"> ,#{fechaProgramada} </if>
        <if test=" idMedico != null"> ,#{idMedico} </if>
        <if test=" idVisita != null"> ,#{idVisita} </if>
        <if test=" fechaIngreso != null"> ,#{fechaIngreso}</if> 
        <if test=" volumenTotal != null"> ,#{volumenTotal} </if>
        <if test=" pesoTotal != null"> ,#{pesoTotal} </if>
        <if test=" caloriasTotal != null"> ,#{caloriasTotal} </if>
        <if test=" calcPesoVolumen != null"> ,#{calcPesoVolumen} </if>
        <if test=" porcenEnergiaTotal != null"> ,#{porcenEnergiaTotal} </if>
        <if test=" monovalentes != null"> ,#{monovalentes} </if>
        <if test=" divalentes != null"> ,#{divalentes} </if>
        <if test=" calcMonovalente != null"> ,#{calcMonovalente} </if>
        <if test=" calcDivalente != null"> ,#{calcDivalente} </if>
        <if test=" precipitacion != null"> ,#{precipitacion} </if>
        <if test=" resultPrecipitacion != null"> ,#{resultPrecipitacion} </if>
        <if test=" estabilidad != null"> ,#{estabilidad} </if>
        <if test=" resultEstabilidad != null"> ,#{resultEstabilidad} </if>
        <if test=" totalOsmolaridad != null"> ,#{totalOsmolaridad} </if>
        <if test=" resulOsmolaridad != null"> ,#{resulOsmolaridad} </if>
        <if test=" infusion != null"> ,#{infusion} </if>
        <if test=" velocInfusion != null"> ,#{velocInfusion} </if>
        <if test = "insertFecha != null"> ,#{insertFecha} </if>
        <if test = "insertIdUsuario != null"> ,#{insertIdUsuario} </if>
        <if test = "updateFecha != null"> ,#{updateFecha} </if>
        <if test = "updateIdUsuario != null"> ,#{updateIdUsuario} </if> 
        <if test=" idSurtimiento != null"> ,#{idSurtimiento}</if>   
        <if test=" edad != null"> ,#{edad} </if>   
        <if test=" peso != null"> ,#{peso} </if>
        <if test=" diagnosticos != null"> ,#{diagnosticos}</if>
        <if test=" fechaNacimiento != null"> , fechaNacimiento = #{ fechaNacimiento } </if>
                <if test=" tallaPaciente != null"> , #{ tallaPaciente } </if>
                <if test=" areaCorporal != null"> , #{ areaCorporal } </if>
                <if test=" tipoConsulta != null"> , #{ tipoConsulta } </if>
                <if test=" diabetes != null"> , #{ diabetes } </if>
                <if test=" problemasRenales != null"> , #{ problemasRenales } </if>
                <if test=" hipertension != null"> , #{ hipertension } </if>
                <if test=" idContenedor != null"> , #{ idContenedor } </if>
                <if test=" fechaParaEntregar != null"> , #{ fechaParaEntregar } </if>
                <if test=" idHorarioParaEntregar != null"> , #{ idHorarioParaEntregar } </if>
                <if test=" perfusionContinua != null"> , #{ perfusionContinua } </if>
                <if test=" velocidad != null"> , #{ velocidad } </if>
                <if test=" tipoPrescripcion != null"> , #{ tipoPrescripcion } </if>
                <if test=" padecimientoCronico != null"> , #{ padecimientoCronico } </if>
                <if test=" idCama != null"> , #{ idCama } </if>
                <if test=" idTipoSolucion != null"> , #{ idTipoSolucion } </if>
                <if test=" idViaAdministracion != null"> , #{ idViaAdministracion } </if>
                <if test=" sobrellenado != null"> , #{ sobrellenado } </if>
                <if test=" horasInfusion != null"> , #{ horasInfusion } </if>
                
                <if test=" kcalProteicas != null"> , #{ kcalProteicas } </if>
                <if test=" kcalNoProteicas != null"> , #{ kcalNoProteicas } </if>
        );
    </insert>
    
    <update id="actualizar" parameterType="mx.mc.model.NutricionParenteral" useGeneratedKeys="false" >        
            UPDATE nutricionParenteral
            <set>                 
                <if test=" folio != null"> folio = #{folio} </if>
                <if test=" idEstructura != null"> ,idEstructura = #{idEstructura} </if>
                <if test=" idPaciente != null"> ,idPaciente = #{idPaciente} </if>
                <if test=" idEstatusSolucion != null"> ,idEstatusSolucion = #{idEstatusSolucion} </if>
                <if test=" fechaPrepara != null"> ,fechaPrepara = #{fechaPrepara} </if>
                <if test=" idRegistro != null"> ,idRegistro = #{idRegistro} </if>
                <if test=" fechaProgramada != null"> ,fechaProgramada =#{fechaProgramada} </if>
                <if test=" idMedico != null"> ,idMedico = #{idMedico} </if>
                <if test=" idVisita != null"> ,idVisita = #{idVisita} </if> 
                <if test=" volumenTotal != null"> ,volumenTotal = #{volumenTotal} </if>
                <if test=" pesoTotal != null"> ,pesoTotal = #{pesoTotal} </if>
                <if test=" caloriasTotal != null"> ,caloriasTotal = #{caloriasTotal} </if>
                <if test=" calcPesoVolumen != null"> ,calcPesoVolumen = #{calcPesoVolumen} </if>
                <if test=" porcenEnergiaTotal != null"> ,porcenEnergiaTotal = #{porcenEnergiaTotal} </if>
                <if test=" monovalentes != null"> ,monovalentes = #{monovalentes} </if>
                <if test=" divalentes != null"> ,divalentes = #{divalentes} </if>
                <if test=" calcMonovalente != null"> ,calcMonovalente = #{calcMonovalente} </if>
                <if test=" calcDivalente != null"> ,calcDivalente = #{calcDivalente} </if>
                <if test=" precipitacion != null"> ,precipitacion = #{precipitacion} </if>
                <if test=" resultPrecipitacion != null"> ,resultPrecipitacion = #{resultPrecipitacion} </if>
                <if test=" estabilidad != null"> ,estabilidad = #{estabilidad} </if>
                <if test=" resultEstabilidad != null"> ,resultEstabilidad = #{resultEstabilidad} </if>
                <if test=" totalOsmolaridad != null"> ,totalOsmolaridad = #{totalOsmolaridad} </if>
                <if test=" resulOsmolaridad != null"> ,resulOsmolaridad = #{resulOsmolaridad} </if>
                <if test=" infusion != null"> ,infusion = #{infusion} </if>
                <if test=" velocInfusion != null"> ,velocInfusion = #{velocInfusion} </if>
                <if test = "updateFecha != null"> ,updateFecha = #{updateFecha} </if>
                <if test = "updateIdUsuario != null"> ,updateIdUsuario = #{updateIdUsuario} </if>
                <if test=" idSurtimiento != null"> ,idSurtimiento = #{idSurtimiento} </if>
                <if test=" edad != null"> ,edad = #{edad} </if>   
                <if test=" peso != null"> ,peso = #{peso} </if>
                <if test=" diagnosticos != null"> ,diagnosticos = #{diagnosticos}</if>
                
                <if test=" fechaNacimiento != null"> , fechaNacimiento = #{ fechaNacimiento } </if>
                <if test=" tallaPaciente != null"> , tallaPaciente = #{ tallaPaciente } </if>
                <if test=" areaCorporal != null"> , areaCorporal = #{ areaCorporal } </if>
                <if test=" tipoConsulta != null"> , tipoConsulta = #{ tipoConsulta } </if>
                <if test=" diabetes != null"> , diabetes = #{ diabetes } </if>
                <if test=" problemasRenales != null"> , problemasRenales = #{ problemasRenales } </if>
                <if test=" hipertension != null"> , hipertension = #{ hipertension } </if>
                <if test=" idContenedor != null"> , idContenedor = #{ idContenedor } </if>
                <if test=" fechaParaEntregar != null"> , fechaParaEntregar = #{ fechaParaEntregar } </if>
                <if test=" idHorarioParaEntregar != null"> , idHorarioParaEntregar = #{ idHorarioParaEntregar } </if>
                <if test=" perfusionContinua != null"> , perfusionContinua = #{ perfusionContinua } </if>
                <if test=" velocidad != null"> , velocidad = #{ velocidad } </if>
                <if test=" tipoPrescripcion != null"> , tipoPrescripcion = #{ tipoPrescripcion } </if>
                <if test=" padecimientoCronico != null"> , padecimientoCronico = #{ padecimientoCronico } </if>
                <if test=" idCama != null"> , idCama = #{ idCama } </if>
                <if test=" idTipoSolucion != null"> , idTipoSolucion = #{ idTipoSolucion } </if>
                <if test=" idViaAdministracion != null"> , idViaAdministracion = #{ idViaAdministracion } </if>
                <if test=" sobrellenado != null"> , sobrellenado = #{ sobrellenado } </if>
                <if test=" horasInfusion != null"> , horasInfusion = #{ horasInfusion } </if>
                
                <if test=" kcalProteicas != null"> , kcalProteicas = #{ kcalProteicas } </if>
                <if test=" kcalNoProteicas != null"> , kcalNoProteicas = #{ kcalNoProteicas } </if>
                
            </set>
             WHERE idNutricionParenteral = #{idNutricionParenteral}         
    </update>
    
    <select id="obtenerBusquedaLazy" parameterType="Map" resultType="mx.mc.model.NutricionParenteralExtended">
        SELECT DISTINCT np.idNutricionParenteral, np.folio, np.folioPreparacion, e.nombre AS nombreEstructura, np.idEstructura
        , np.idEstatusSolucion, CONCAT(p.nombreCompleto, ' ', p.apellidoPaterno, ' ', p.apellidoMaterno) AS nombrePaciente
        , p.claveDerechohabiencia, p.pacienteNumero, np.idPaciente, np.idSurtimiento, u.nombreUsuario AS prescribio, v.numVisita AS numeroVisita
        , np.fechaIngreso, np.fechaPrepara, np.fechaProgramada, np.idRegistro, np.idMedico, np.idVisita, np.volumenTotal, np.pesoTotal, np.caloriasTotal
        , np.calcPesoVolumen, np.porcenEnergiaTotal, np.monovalentes, np.divalentes, np.calcMonovalente, np.calcDivalente, np.precipitacion
        , np.resultPrecipitacion, np.estabilidad, np.resultEstabilidad, es.descripcion AS estatus, np.totalOsmolaridad, np.resulOsmolaridad
        , np.infusion, np.velocInfusion, np.edad, np.peso, np.diagnosticos
        , IFNULL(c.nombreCama, '') as ubicacion
        , np.fechaNacimiento , np.tallaPaciente , np.areaCorporal , np.tipoConsulta , np.diabetes
        , np.problemasRenales , np.hipertension , np.idContenedor , np.fechaParaEntregar
        , np.idHorarioParaEntregar , np.perfusionContinua , np.velocidad , np.tipoPrescripcion
        , np.padecimientoCronico , np.idCama , np.idTipoSolucion , np.idViaAdministracion
        , np.idEstructura , np.sobrellenado , np.horasInfusion , np.kcalProteicas , np.kcalNoProteicas
        FROM nutricionParenteral np 
        JOIN estatusSolucion es ON np.idEstatusSolucion = es.idEstatusSolucion 
        JOIN paciente p ON np.idPaciente = p.idPaciente 
        JOIN usuarios u ON np.idRegistro = u.idUsuario 
        JOIN estructura e ON np.idEstructura = e.idEstructura 
        LEFT JOIN usuarios um ON np.idMedico = um.idUsuario 
        LEFT JOIN visita v ON np.idPaciente = v.idPaciente  
        LEFT JOIN cama c ON np.idCama = c.idCama 
<!--        LEFT JOIN pacienteServicio ps ON v.idVisita = ps.idVisita 
        LEFT join pacienteUbicacion pu ON ps.idPacienteServicio = pu.idPacienteServicio
        LEFT JOIN cama c ON pu.idCama = c.idCama WHERE 1 = 1-->
        WHERE 1 = 1
        <!--<if test=" tipoPrescripcion != null "> AND UPPER ( p.tipoPrescripcion ) LIKE UPPER (SUBSTRING( #{ tipoPrescripcion } , 1,1 ) ) </if>-->
        <if test=" estatusSolucion != null "> AND UPPER( es.descripcion ) LIKE UPPER( '%${ estatusSolucion }%' ) </if>
        <if test=" nombreEstructura != null "> AND UPPER( e.nombre ) LIKE UPPER( '%${ nombreEstructura }%' ) </if>
        <if test=" tipoSolucion != null "> AND UPPER( ts.clave ) LIKE UPPER( '%${ tipoSolucion }%' ) </if>
        <if test=" nombreMedico != null "> AND UPPER( CONCAT(um.apellidoPaterno , ' ' , um.apellidoMaterno , ' ' , um.nombre ) ) LIKE UPPER( '%${ nombreMedico }%' ) </if>
        <if test=" folioPrescripcion != null "> AND UPPER( np.folio ) LIKE UPPER( '%${ folioPrescripcion }%' ) </if>
        <if test=" fechaProgramada2 != null "> AND date_format(np.fechaProgramada , '%Y-%m-%d %H:%i' ) LIKE '%${ fechaProgramada2 }%' </if>
        <if test=" nombrePaciente != null "> AND UPPER( CONCAT(p.apellidoPaterno , ' ' , p.apellidoMaterno , ' , ' , p.nombreCompleto ) ) LIKE UPPER( '%${ nombrePaciente }%' ) </if>
        <if test=" cama != null "> AND UPPER( c.nombreCama ) LIKE UPPER( '%${ cama }%' ) </if>
        <if test=" folio != null "> AND UPPER( np.folioPreparacion ) LIKE UPPER( '%${ folio }%' ) </if>
        
        <!--AND ps.fechaAsignacionFin IS NULL-->
        <if test="cadena != null">
            AND (idNutricionParenteral like '%${cadena}%'
            OR folio like '%${cadena}%')
        </if>
<!--        <if test="idEstructura != null">
            AND e.idEstructura = #{idEstructura}
        </if>-->
        <if test=" estatusSolucionLista != null ">
            AND np.idEstatusSolucion IN 
            <foreach item="item" index="index" collection="estatusSolucionLista" open="(" separator="," close=")">
                #{ item }
            </foreach>
        </if>
        
        ORDER BY np.insertFecha desc
        LIMIT #{startingAt}, #{maxPerPage}    
    </select>
    
    <select id="obtenerBusquedaTotalLazy" parameterType="Map" resultType="Long">
         SELECT count(*) AS total 
        FROM nutricionParenteral np  
        INNER JOIN estatusSolucion es ON np.idEstatusSolucion = es.idEstatusSolucion  
        INNER JOIN paciente p ON np.idPaciente = p.idPaciente
        INNER JOIN usuarios u ON np.idRegistro = u.idUsuario
        INNER JOIN usuarios um ON np.idMedico = um.idUsuario
        INNER JOIN estructura e ON np.idEstructura = e.idEstructura
        LEFT JOIN visita v ON np.idPaciente = v.idPaciente 
<!--        LEFT JOIN pacienteServicio ps ON v.idVisita = ps.idVisita 
        LEFT join pacienteUbicacion pu ON ps.idPacienteServicio = pu.idPacienteServicio
        LEFT JOIN cama c ON pu.idCama = c.idCama -->
        WHERE 1 = 1
        <!--<if test=" tipoPrescripcion != null "> AND UPPER ( p.tipoPrescripcion ) LIKE UPPER (SUBSTRING( #{ tipoPrescripcion } , 1,1 ) ) </if>-->
        <!--<if test=" estatusSolucion != null "> AND UPPER( es.descripcion ) LIKE UPPER( '%${ estatusSolucion }%' ) </if>-->
        <if test=" nombreEstructura != null "> AND UPPER( e.nombre ) LIKE UPPER( '%${ nombreEstructura }%' ) </if>
        <if test=" tipoSolucion != null "> AND UPPER( ts.clave ) LIKE UPPER( '%${ tipoSolucion }%' ) </if>
        <if test=" nombreMedico != null "> AND UPPER( CONCAT(um.apellidoPaterno , ' ' , um.apellidoMaterno , ' ' , um.nombre ) ) LIKE UPPER( '%${ nombreMedico }%' ) </if>
        <if test=" folioPrescripcion != null "> AND UPPER( np.folio ) LIKE UPPER( '%${ folioPrescripcion }%' ) </if>
        <if test=" fechaProgramada2 != null "> AND date_format(np.fechaProgramada , '%Y-%m-%d %H:%i' ) LIKE '%${ fechaProgramada2 }%' </if>
        <if test=" nombrePaciente != null "> AND UPPER( CONCAT(p.apellidoPaterno , ' ' , p.apellidoMaterno , ' , ' , p.nombreCompleto ) ) LIKE UPPER( '%${ nombrePaciente }%' ) </if>
        <if test=" cama != null "> AND UPPER( c.nombreCama ) LIKE UPPER( '%${ cama }%' ) </if>
        <if test=" folio != null "> AND UPPER( np.folioPreparacion ) LIKE UPPER( '%${ folio }%' ) </if>
        
        <if test="cadena != null">
            AND (idNutricionParenteral like '%${cadena}%'
            OR folio like '%${cadena}%')
        </if>
<!--        <if test="idEstructura != null">
            AND e.idEstructura = #{idEstructura}
        </if>-->
        <if test=" estatusSolucionLista != null ">
            AND np.idEstatusSolucion IN 
            <foreach item="item" index="index" collection="estatusSolucionLista" open="(" separator="," close=")">
                #{ item }
            </foreach>
        </if>
    </select>
    
    <select id="obtenerNutricionParenteralById" parameterType="Map" resultType="mx.mc.model.NutricionParenteralExtended">
        SELECT np.idNutricionParenteral, np.folio, np.folioPreparacion, e.nombre AS nombreEstructura
        , CONCAT(p.nombreCompleto, ' ', p.apellidoPaterno, ' ', p.apellidoMaterno) AS nombrePaciente, p.claveDerechohabiencia
        , p.pacienteNumero, np.idPaciente, u.nombreUsuario AS prescribio, v.numVisita AS numeroVisita, np.fechaIngreso, np.fechaPrepara
        , np.fechaProgramada, np.idRegistro, np.idMedico, np.idVisita, np.volumenTotal, np.pesoTotal, np.caloriasTotal, np.calcPesoVolumen
        , np.porcenEnergiaTotal, np.monovalentes, np.divalentes, np.calcMonovalente, np.idEstatusSolucion, es.descripcion AS estatus
        ,np.calcDivalente, np.precipitacion, np.resultPrecipitacion, np.estabilidad, np.resultEstabilidad, np.totalOsmolaridad
        , np.resulOsmolaridad, np.infusion, np.velocInfusion, np.idSurtimiento, np.edad, np.peso, np.diagnosticos
        , IFNULL(c.nombreCama, '') as ubicacion
        , np.fechaNacimiento , np.tallaPaciente , np.areaCorporal , np.tipoConsulta , np.diabetes
        , np.problemasRenales , np.hipertension , np.idContenedor , np.fechaParaEntregar
        , np.idHorarioParaEntregar , np.perfusionContinua , np.velocidad , np.tipoPrescripcion
        , np.padecimientoCronico , np.idCama , np.idTipoSolucion , np.idViaAdministracion
        , np.idEstructura , np.sobrellenado , np.horasInfusion , np.kcalProteicas , np.kcalNoProteicas
        FROM nutricionParenteral np 
        JOIN estatusSolucion es ON np.idEstatusSolucion = es.idEstatusSolucion 
        JOIN paciente p ON np.idPaciente = p.idPaciente 
        JOIN usuarios u ON np.idRegistro = u.idUsuario 
        JOIN estructura e ON np.idEstructura = e.idEstructura 
        LEFT JOIN usuarios um ON np.idMedico = um.idUsuario 
        LEFT JOIN visita v ON np.idPaciente = v.idPaciente  
        LEFT JOIN cama c ON np.idCama = c.idCama 
        WHERE idNutricionParenteral = #{idNutricionParenteral, jdbcType=VARCHAR}
        ORDER BY v.insertFecha DESC
        LIMIT 1;
    </select>
    
    <select id="obtener" parameterType="mx.mc.model.NutricionParenteral" resultType="mx.mc.model.NutricionParenteralExtended">
        SELECT * FROM nutricionParenteral np  
        WHERE 1 = 1
        <if test=" idNutricionParenteral != null">
            AND idNutricionParenteral = #{ idNutricionParenteral }
        </if>
        <if test=" idSurtimiento != null">
            AND idSurtimiento = #{ idSurtimiento }
        </if>
        <if test=" folio != null">
            AND folio = #{ folio }
        </if>
        LIMIT 1;
    </select>
    
    
    
</mapper>